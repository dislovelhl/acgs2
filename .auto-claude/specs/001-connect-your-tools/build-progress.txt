# Linear Integration for ACGS2 - Build Progress

**Spec ID:** 001-connect-your-tools
**Workflow Type:** feature
**Status:** Ready to Start
**Total Estimated Hours:** 80 hours

## Overview

Implementation of Linear integration into ACGS2 integration-service to enable bidirectional synchronization between Linear issues and external tools (GitHub, GitLab, Slack).

## Implementation Plan Created

✅ Implementation plan created with 5 phases and 30 subtasks
✅ All phases defined with clear dependencies and acceptance criteria
✅ QA checklist established with unit tests, integration tests, and API verification
✅ Success criteria documented from spec

## Phase Status

### Phase 1: Foundation & Setup (3/8 subtasks complete)
- [✅] 1.1 - Verify package availability on PyPI
- [✅] 1.2 - Verify Linear GraphQL API documentation
- [✅] 1.3 - Verify GitHub, GitLab, Slack API documentation
- [ ] 1.4 - Add Linear dependencies to requirements.txt
- [ ] 1.5 - Update .env.example with Linear variables
- [ ] 1.6 - Create Linear configuration class
- [ ] 1.7 - Implement Linear GraphQL client
- [ ] 1.8 - Write unit tests for Linear client

### Phase 2: Webhook Infrastructure (0/5 subtasks complete)
- [ ] 2.1 - Create Pydantic models for webhook payloads
- [ ] 2.2 - Implement webhook signature verification
- [ ] 2.3 - Create Linear webhook endpoint handler
- [ ] 2.4 - Set up Redis state tracking
- [ ] 2.5 - Write unit tests for webhook handler

### Phase 3: GitHub & GitLab Sync (0/6 subtasks complete)
- [ ] 3.1 - Implement deduplication logic with Redis
- [ ] 3.2 - Implement conflict resolution (last-write-wins)
- [ ] 3.3 - Build GitHub sync manager
- [ ] 3.4 - Build GitLab sync manager
- [ ] 3.5 - Write unit tests for GitHub sync
- [ ] 3.6 - Write unit tests for GitLab sync

### Phase 4: Slack Integration (0/4 subtasks complete)
- [ ] 4.1 - Create Slack notification service
- [ ] 4.2 - Create Slack message templates (Block Kit)
- [ ] 4.3 - Wire Slack notifier into sync engine
- [ ] 4.4 - Write unit tests for Slack notifier

### Phase 5: Testing & Documentation (0/10 subtasks complete)
- [ ] 5.1 - Register Linear routes in main.py
- [ ] 5.2 - Write integration tests for Linear → GitHub
- [ ] 5.3 - Write integration tests for Linear → GitLab
- [ ] 5.4 - Write integration test for Linear → Slack
- [ ] 5.5 - Write end-to-end test for complete flow
- [ ] 5.6 - Write tests for deduplication logic
- [ ] 5.7 - Write tests for conflict resolution
- [ ] 5.8 - Run full test suite (≥80% coverage)
- [ ] 5.9 - Update API documentation
- [ ] 5.10 - Create init.sh for environment setup

## Critical Notes

⚠️ **VERIFICATION REQUIRED:**
All package names, versions, and API patterns in the spec are based on research findings that have NOT been verified against live documentation. Before implementation:
- Verify package existence and correct names on PyPI
- Confirm current version compatibility
- Review API endpoints and authentication methods
- Check rate limits and webhook signature verification methods

## Recent Progress

✅ **Task 1.1 Complete** (2026-01-03): Verified all packages on PyPI
   - gql 4.0.0 available (req: >=3.5.0) ✅
   - PyGithub 2.8.1 available (req: >=2.1.0) ✅
   - python-gitlab 7.1.0 available (req: >=4.4.0) ✅
   - slack-sdk 3.39.0 available (req: >=3.33.0) ✅
   - Report: pypi-package-verification.md

✅ **Task 1.2 Complete** (2026-01-03): Linear API verification documented
   - GraphQL endpoint: https://api.linear.app/graphql
   - Authentication: Bearer token
   - Webhook signature: HMAC-SHA256
   - Rate limiting patterns documented
   - Report: linear-api-verification.md
   - ⚠️ Manual verification required before implementation

✅ **Task 1.3 Complete** (2026-01-03): GitHub, GitLab, Slack API verification documented
   - GitHub: REST API + GraphQL, Bearer token auth, 5000 req/hr rate limit
   - GitLab: REST API v4, PRIVATE-TOKEN auth, 300 req/min rate limit
   - Slack: Web API, Bot token (xoxb-*) auth, tiered rate limits
   - Webhook signatures: GitHub (HMAC-SHA256), GitLab (simple token), Slack (HMAC-SHA256)
   - Library patterns: PyGithub, python-gitlab, slack-sdk (AsyncWebClient)
   - Report: github-gitlab-slack-api-verification.md
   - ⚠️ Manual verification required before implementation

## Next Steps

1. **NEXT: TASK 1.4**: Add Linear dependencies to requirements.txt
   - Add: gql[all]>=3.5.0, PyGithub>=2.1.0, python-gitlab>=4.4.0, slack-sdk>=3.33.0
   - Follow existing requirements.txt format

2. After dependencies added, proceed to task 1.5 (Update .env.example)

3. Follow the implementation plan sequentially, respecting task dependencies

## Files to Track

### To Create:
- integration-service/src/config.py (if doesn't exist)
- integration-service/src/integrations/linear/client.py
- integration-service/src/integrations/linear/models.py
- integration-service/src/integrations/linear/webhook_auth.py
- integration-service/src/integrations/linear/state.py
- integration-service/src/integrations/linear/deduplication.py
- integration-service/src/integrations/linear/conflict_resolution.py
- integration-service/src/integrations/linear/github_sync.py
- integration-service/src/integrations/linear/gitlab_sync.py
- integration-service/src/integrations/linear/slack_notifier.py
- integration-service/src/integrations/linear/slack_templates.py
- integration-service/src/api/linear_webhooks.py
- Multiple test files

### To Modify:
- integration-service/requirements.txt
- integration-service/.env.example
- integration-service/src/main.py

---

**Last Updated:** 2026-01-03T22:00:00.000Z
**Plan Status:** In Progress - Phase 1 (3/8 tasks complete)
