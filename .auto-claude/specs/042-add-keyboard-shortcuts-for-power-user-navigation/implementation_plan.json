{
  "spec_id": "042-add-keyboard-shortcuts-for-power-user-navigation",
  "title": "Add Keyboard Shortcuts for Power User Navigation",
  "version": "1.0.0",
  "created_at": "2026-01-04T00:00:00Z",
  "updated_at": "2026-01-04T10:38:42.257Z",
  "status": "done",
  "overview": {
    "description": "Implement keyboard shortcuts for common actions: Enter to submit query, Escape to clear, and R to refresh the currently focused widget. Enhance power user productivity across Policy Playground and Monitoring Dashboard.",
    "goals": [
      "Add global keyboard shortcuts for submit (Enter), clear (Escape), and refresh (R)",
      "Implement context-aware shortcuts that work with focused widgets",
      "Provide visual feedback for keyboard actions",
      "Add keyboard shortcut help panel/tooltip",
      "Maintain accessibility and prevent conflicts with existing browser/app shortcuts"
    ],
    "affected_components": [
      "acgs2-core/playground/frontend (Policy Playground - Vanilla JS)",
      "acgs2-observability/monitoring/dashboard (Monitoring Dashboard - React/TypeScript)"
    ]
  },
  "phases": [
    {
      "phase_id": "phase-1",
      "name": "Policy Playground Keyboard Shortcuts Enhancement",
      "description": "Enhance existing keyboard shortcuts in the Policy Playground with Escape to clear and R to refresh functionality",
      "dependencies": [],
      "subtasks": [
        {
          "subtask_id": "1.1",
          "title": "Add Escape key handler for clearing editors",
          "description": "Implement Escape key handler that clears the currently focused editor (policy or input) in the Policy Playground. Should also clear results and reset status.",
          "files_to_modify": [
            "acgs2-core/playground/frontend/app.js"
          ],
          "acceptance_criteria": [
            "Pressing Escape when policy editor is focused clears policy content",
            "Pressing Escape when input editor is focused clears input content",
            "Pressing Escape when neither editor is focused clears both editors and results",
            "Status message updates to show what was cleared",
            "Clear action is prevented when in loading state"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "1.2",
          "title": "Add R key handler for refreshing connection",
          "description": "Implement R key handler that refreshes the OPA connection status and reloads examples in the Policy Playground.",
          "files_to_modify": [
            "acgs2-core/playground/frontend/app.js"
          ],
          "acceptance_criteria": [
            "Pressing R key triggers connection check",
            "Pressing R key reloads examples from backend",
            "Status indicator updates during refresh",
            "Refresh is prevented when in loading state",
            "Visual feedback indicates refresh is in progress"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "1.3",
          "title": "Add keyboard shortcuts help panel for Policy Playground",
          "description": "Create a help panel/modal that displays all available keyboard shortcuts. Should be toggleable with ? key or Help button.",
          "files_to_modify": [
            "acgs2-core/playground/frontend/app.js",
            "acgs2-core/playground/frontend/index.html"
          ],
          "acceptance_criteria": [
            "Pressing ? or Shift+/ shows keyboard shortcuts help modal",
            "Help modal displays all shortcuts (Enter, Escape, R, Ctrl+Enter, Ctrl+Shift+V, Tab)",
            "Help modal can be closed with Escape or close button",
            "Help button/icon is visible in the UI",
            "Help modal has clear, readable formatting"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        }
      ]
    },
    {
      "phase_id": "phase-2",
      "name": "Monitoring Dashboard Keyboard Shortcuts",
      "description": "Implement comprehensive keyboard shortcuts for the React-based Monitoring Dashboard with widget focus management",
      "dependencies": [
        "phase-1"
      ],
      "subtasks": [
        {
          "subtask_id": "2.1",
          "title": "Create keyboard shortcuts hook for React",
          "description": "Create a reusable React hook (useKeyboardShortcuts) for managing keyboard shortcuts in the monitoring dashboard. Should handle event listeners, cleanup, and prevent conflicts.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/hooks/useKeyboardShortcuts.ts"
          ],
          "acceptance_criteria": [
            "Hook accepts keyboard shortcut configuration",
            "Hook properly sets up and cleans up event listeners",
            "Hook prevents default browser behavior when needed",
            "Hook respects input/textarea focus to avoid conflicts",
            "Hook is TypeScript-typed with proper interfaces"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "2.2",
          "title": "Implement R key for dashboard refresh",
          "description": "Add R key handler to trigger full dashboard refresh (all widgets). Should provide visual feedback during refresh.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx"
          ],
          "acceptance_criteria": [
            "Pressing R key triggers handleRefresh function",
            "Visual indicator shows refresh is in progress",
            "Last update timestamp updates after refresh completes",
            "Refresh works same as clicking the Refresh button",
            "R key is disabled when already refreshing"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "2.3",
          "title": "Add Escape key handler for clearing filters/selections",
          "description": "Implement Escape key handler that clears any active filters, selections, or modals in the dashboard. Should be context-aware.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-observability/monitoring/dashboard/src/components/AlertsList.tsx",
            "acgs2-observability/monitoring/dashboard/src/components/ServiceGrid.tsx"
          ],
          "acceptance_criteria": [
            "Pressing Escape clears any active alert selections",
            "Pressing Escape resets any filtered views",
            "Escape has no effect when there's nothing to clear",
            "Visual feedback confirms what was cleared",
            "Escape doesn't interfere with modal dialogs (if any)"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "2.4",
          "title": "Add keyboard shortcuts help modal for Dashboard",
          "description": "Create a help modal component that displays all available keyboard shortcuts. Should be accessible via ? key or Help button in header.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/KeyboardShortcutsModal.tsx",
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-observability/monitoring/dashboard/src/components/index.ts"
          ],
          "acceptance_criteria": [
            "Pressing ? or Shift+/ opens shortcuts help modal",
            "Modal displays all shortcuts (R for refresh, Escape for clear, ? for help)",
            "Modal can be closed with Escape, X button, or clicking outside",
            "Help icon/button is visible in dashboard header",
            "Modal is styled consistently with dashboard theme",
            "Modal is accessible (ARIA labels, keyboard navigation)"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "2.5",
          "title": "Export keyboard shortcuts hook to hooks index",
          "description": "Export the new useKeyboardShortcuts hook from the hooks index file for easy importing.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/hooks/index.ts"
          ],
          "acceptance_criteria": [
            "useKeyboardShortcuts is exported from hooks/index.ts",
            "Other components can import the hook easily",
            "No circular dependencies introduced"
          ],
          "estimated_effort": "15 minutes",
          "status": "pending",
          "notes": ""
        }
      ]
    },
    {
      "phase_id": "phase-3",
      "name": "Testing and Documentation",
      "description": "Add comprehensive tests for keyboard shortcuts and update documentation",
      "dependencies": [
        "phase-1",
        "phase-2"
      ],
      "subtasks": [
        {
          "subtask_id": "3.1",
          "title": "Add unit tests for keyboard shortcuts hook",
          "description": "Create unit tests for the useKeyboardShortcuts React hook with various scenarios and edge cases.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/hooks/__tests__/useKeyboardShortcuts.test.ts"
          ],
          "acceptance_criteria": [
            "Tests verify keyboard event handling",
            "Tests verify cleanup on unmount",
            "Tests verify prevention of default behavior",
            "Tests verify input/textarea exclusion logic",
            "All tests pass with >80% coverage"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "3.2",
          "title": "Add tests for KeyboardShortcutsModal component",
          "description": "Create unit tests for the KeyboardShortcutsModal component testing rendering and interactions.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/__tests__/KeyboardShortcutsModal.test.tsx"
          ],
          "acceptance_criteria": [
            "Tests verify modal opens and closes correctly",
            "Tests verify all shortcuts are displayed",
            "Tests verify keyboard navigation works",
            "Tests verify accessibility attributes",
            "All tests pass"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "3.3",
          "title": "Add integration tests for Dashboard keyboard shortcuts",
          "description": "Create integration tests that verify keyboard shortcuts work correctly in the full Dashboard component.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/__tests__/Dashboard.test.tsx"
          ],
          "acceptance_criteria": [
            "Tests verify R key triggers refresh",
            "Tests verify Escape key clears state",
            "Tests verify ? key opens help modal",
            "Tests verify shortcuts don't fire during loading",
            "All tests pass"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "3.4",
          "title": "Create manual testing guide",
          "description": "Document manual testing procedures for all keyboard shortcuts across both applications.",
          "files_to_modify": [
            "./.auto-claude/specs/042-add-keyboard-shortcuts-for-power-user-navigation/testing-guide.md"
          ],
          "acceptance_criteria": [
            "Guide covers all keyboard shortcuts",
            "Guide includes expected behaviors",
            "Guide includes edge cases to test",
            "Guide includes cross-browser testing notes",
            "Guide includes accessibility testing steps"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "3.5",
          "title": "Update project documentation",
          "description": "Update README files and user guides to document the new keyboard shortcuts feature.",
          "files_to_modify": [
            "acgs2-core/playground/README.md",
            "acgs2-observability/monitoring/dashboard/README.md",
            "docs/user-guide/keyboard-shortcuts.md"
          ],
          "acceptance_criteria": [
            "Policy Playground README documents shortcuts",
            "Monitoring Dashboard README documents shortcuts",
            "User guide includes comprehensive keyboard shortcuts reference",
            "Documentation includes screenshots/examples",
            "Documentation is clear and easy to follow"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        }
      ]
    },
    {
      "phase_id": "phase-4",
      "name": "Polish and Accessibility",
      "description": "Polish the implementation with visual feedback, accessibility improvements, and edge case handling",
      "dependencies": [
        "phase-2",
        "phase-3"
      ],
      "subtasks": [
        {
          "subtask_id": "4.1",
          "title": "Add visual feedback for keyboard actions",
          "description": "Implement visual feedback (toast notifications, status indicators, animations) when keyboard shortcuts are triggered.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-core/playground/frontend/app.js"
          ],
          "acceptance_criteria": [
            "Brief visual feedback appears when R is pressed",
            "Status message updates when Escape is pressed",
            "Feedback is non-intrusive and tasteful",
            "Feedback respects user's reduced motion preferences",
            "Feedback is consistent across both applications"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "4.2",
          "title": "Ensure ARIA labels and screen reader support",
          "description": "Add proper ARIA labels and ensure keyboard shortcuts are announced to screen readers when appropriate.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/KeyboardShortcutsModal.tsx",
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-core/playground/frontend/index.html"
          ],
          "acceptance_criteria": [
            "Help buttons have proper ARIA labels",
            "Modal has proper ARIA role and labels",
            "Keyboard actions announce to screen readers when needed",
            "Focus management is logical and accessible",
            "Passes axe-core accessibility audit"
          ],
          "estimated_effort": "1-2 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "4.3",
          "title": "Handle edge cases and conflicts",
          "description": "Identify and handle edge cases like multiple rapid key presses, shortcuts during loading states, and conflicts with browser shortcuts.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/hooks/useKeyboardShortcuts.ts",
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-core/playground/frontend/app.js"
          ],
          "acceptance_criteria": [
            "Debouncing prevents multiple rapid triggers",
            "Shortcuts disabled during loading states",
            "No conflicts with common browser shortcuts",
            "Shortcuts don't fire in input/textarea elements",
            "Graceful handling of unexpected scenarios"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        },
        {
          "subtask_id": "4.4",
          "title": "Add keyboard shortcuts preference toggle",
          "description": "Add optional user preference to enable/disable keyboard shortcuts for users who may have conflicts with assistive technologies.",
          "files_to_modify": [
            "acgs2-observability/monitoring/dashboard/src/components/Dashboard.tsx",
            "acgs2-observability/monitoring/dashboard/src/hooks/useKeyboardShortcuts.ts"
          ],
          "acceptance_criteria": [
            "Settings panel includes keyboard shortcuts toggle",
            "Preference is stored in localStorage",
            "Shortcuts can be completely disabled if needed",
            "Help modal indicates if shortcuts are disabled",
            "Default is enabled for all users"
          ],
          "estimated_effort": "2-3 hours",
          "status": "pending",
          "notes": ""
        }
      ]
    }
  ],
  "qa_signoff": {
    "status": "pending",
    "tested_at": null,
    "tested_by": null,
    "tests_passed": null,
    "issues": [],
    "notes": ""
  },
  "implementation_notes": {
    "key_decisions": [
      "Use native keyboard event listeners rather than a library to minimize dependencies",
      "Implement context-aware shortcuts that respect focused elements",
      "Provide help modal accessible via ? key for discoverability",
      "Add visual feedback for all keyboard actions",
      "Include accessibility considerations from the start"
    ],
    "technical_considerations": [
      "Prevent conflicts with browser default shortcuts (avoid Ctrl+R, Ctrl+W, etc.)",
      "Handle both Windows (Ctrl) and Mac (Cmd) modifier keys",
      "Ensure shortcuts don't fire when typing in input fields",
      "Clean up event listeners properly to prevent memory leaks",
      "Consider internationalized keyboard layouts"
    ],
    "risks": [
      "Potential conflicts with browser extensions using same shortcuts",
      "Different behavior across browsers may require testing",
      "Screen reader compatibility needs validation",
      "May need to adjust shortcuts based on user feedback"
    ]
  },
  "success_metrics": {
    "acceptance_criteria": [
      "All keyboard shortcuts work reliably across Chrome, Firefox, Safari, and Edge",
      "No conflicts with existing form submissions or browser shortcuts",
      "Help modal is discoverable and informative",
      "Shortcuts improve efficiency for power users without hindering regular users",
      "Accessibility audit passes with no critical issues",
      "All unit and integration tests pass",
      "Documentation is clear and comprehensive"
    ],
    "performance_targets": [
      "Keyboard events handled within 50ms",
      "No memory leaks from event listeners",
      "No impact on initial page load time"
    ]
  },
  "planStatus": "completed"
}