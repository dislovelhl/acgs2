{
  "file_path": "claude-flow/src/services/swarmService.ts",
  "main_branch_history": [],
  "task_views": {
    "059-add-jsdoc-coverage-for-claude-flow-typescript-serv": {
      "task_id": "059-add-jsdoc-coverage-for-claude-flow-typescript-serv",
      "branch_point": {
        "commit_hash": "fc6e42927298263034acf989773f3200e422ad17",
        "content": "import { spawn } from \"child_process\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\nimport logger from \"../utils/logger.js\";\n\nexport interface SwarmConfig {\n  topology: \"mesh\" | \"hierarchical\" | \"ring\" | \"star\";\n  maxAgents: number;\n  strategy: \"balanced\" | \"parallel\" | \"sequential\";\n  autoSpawn: boolean;\n  memory: boolean;\n  github: boolean;\n}\n\nexport interface SwarmInitResult {\n  success: boolean;\n  swarmId?: string;\n  error?: string;\n}\n\nexport async function initializeSwarm(\n  config: SwarmConfig\n): Promise<SwarmInitResult> {\n  try {\n    // Path to the Python swarm initializer script\n    // Use src path for development, fallback to dist for production\n    let initializerPath = path.join(__dirname, \"swarmInitializer.py\");\n    if (!require(\"fs\").existsSync(initializerPath)) {\n      // Try the src path from dist\n      initializerPath = path.join(\n        __dirname,\n        \"../../src/services/swarmInitializer.py\"\n      );\n    }\n\n    // Prepare arguments for the Python script\n    const args = [\n      initializerPath,\n      config.topology,\n      config.maxAgents.toString(),\n      config.strategy,\n      config.autoSpawn.toString(),\n      config.memory.toString(),\n      config.github.toString(),\n    ];\n\n    // Spawn the Python process\n    const result = await runPythonScript(args);\n\n    if (result.success) {\n      return {\n        success: true,\n        swarmId: result.swarmId,\n      };\n    } else {\n      return {\n        success: false,\n        error: result.error,\n      };\n    }\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown error occurred\",\n    };\n  }\n}\n\nasync function runPythonScript(args: string[]): Promise<any> {\n  return new Promise((resolve, reject) => {\n    const pythonProcess = spawn(\"python3\", args, {\n      stdio: [\"pipe\", \"pipe\", \"pipe\"],\n      cwd: path.dirname(args[0]),\n    });\n\n    let stdout = \"\";\n    let stderr = \"\";\n\n    pythonProcess.stdout.on(\"data\", (data) => {\n      stdout += data.toString();\n    });\n\n    pythonProcess.stderr.on(\"data\", (data) => {\n      stderr += data.toString();\n    });\n\n    pythonProcess.on(\"close\", (code) => {\n      if (code === 0) {\n        try {\n          const result = JSON.parse(stdout.trim());\n          resolve(result);\n        } catch (e) {\n          reject(new Error(`Failed to parse Python output: ${stdout}`));\n        }\n      } else {\n        reject(new Error(`Python script failed with code ${code}: ${stderr}`));\n      }\n    });\n\n    pythonProcess.on(\"error\", (error) => {\n      reject(error);\n    });\n  });\n}\n\nexport async function getSwarmStatus(): Promise<any> {\n  try {\n    // Path to the Python swarm status script\n    let statusPath = path.join(__dirname, \"swarmStatus.py\");\n    if (!require(\"fs\").existsSync(statusPath)) {\n      // Try the src path from dist\n      statusPath = path.join(__dirname, \"../../src/services/swarmStatus.py\");\n    }\n\n    // Run the Python script to get swarm status\n    const result = await runPythonScript([statusPath]);\n\n    if (result.success) {\n      return result.status || {};\n    } else {\n      logger.warn({ error: result.error }, \"Failed to get swarm status\");\n      return null;\n    }\n  } catch (error) {\n    console.warn(\"Error getting swarm status:\", error);\n    return {};\n  }\n}\n\nexport interface SwarmShutdownResult {\n  success: boolean;\n  message?: string;\n  error?: string;\n}\n\nexport async function shutdownSwarm(): Promise<SwarmShutdownResult> {\n  try {\n    // Path to the Python swarm shutdown script\n    // Use src path for development, fallback to dist for production\n    let shutdownPath = path.join(__dirname, 'swarmShutdown.py');\n    if (!require('fs').existsSync(shutdownPath)) {\n      // Try the src path from dist\n      shutdownPath = path.join(__dirname, '../../src/services/swarmShutdown.py');\n    }\n\n    // Check if shutdown script exists before attempting to run it\n    if (!require('fs').existsSync(shutdownPath)) {\n      // No shutdown script available - return success as graceful no-op\n      // This is valid when swarm infrastructure is not configured\n      return {\n        success: true,\n        message: 'Swarm shutdown skipped: no shutdown script configured'\n      };\n    }\n\n    // Run the Python script to shutdown the swarm\n    const result = await runPythonScript([shutdownPath]);\n\n    if (result.success) {\n      return {\n        success: true,\n        message: result.message || 'Swarm shutdown completed successfully'\n      };\n    } else {\n      // Shutdown script ran but reported failure\n      console.warn('Swarm shutdown reported failure:', result.error);\n      return {\n        success: false,\n        error: result.error || 'Swarm shutdown failed'\n      };\n    }\n\n  } catch (error) {\n    // Handle unexpected errors during shutdown gracefully\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\n    console.warn('Error during swarm shutdown:', errorMessage);\n\n    // Return success anyway - shutdown should be idempotent\n    // If we can't connect to shutdown, assume swarm is already down\n    return {\n      success: true,\n      message: 'Swarm shutdown completed (no active swarm found)',\n      error: errorMessage\n    };\n  }\n}\n",
        "timestamp": "2026-01-04T05:35:52.969195"
      },
      "worktree_state": null,
      "task_intent": {
        "title": "Add JSDoc coverage for claude-flow TypeScript service public exports",
        "description": "Add comprehensive JSDoc documentation to the 45 exported functions/classes across 17 TypeScript files in the claude-flow CLI tool to improve API documentation for enterprise users",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-04T05:35:53.089249",
  "last_updated": "2026-01-04T05:35:53.092287"
}