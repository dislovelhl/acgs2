{
  "file_path": "src/core/shared/security/__init__.py",
  "main_branch_history": [],
  "task_views": {
    "046-add-security-headers-middleware-to-fastapi-service": {
      "task_id": "046-add-security-headers-middleware-to-fastapi-service",
      "branch_point": {
        "commit_hash": "4a99fe22e8e0087919301b1aa185d4e2c6da716c",
        "content": "\"\"\"\nACGS-2 Security Module\nConstitutional Hash: cdd01ef066bc6cf2\n\nCentralized security utilities for the ACGS-2 platform:\n- CORS configuration and validation\n- Rate limiting middleware\n- Tenant context middleware for multi-tenant isolation\n- API key and token management\n- Security headers enforcement\n\"\"\"\n\nfrom .cors_config import (\n    DEFAULT_ORIGINS,\n    CORSConfig,\n    CORSEnvironment,\n    detect_environment,\n    get_cors_config,\n    get_strict_cors_config,\n    validate_origin,\n)\nfrom .rate_limiter import (\n    REDIS_AVAILABLE,\n    TENANT_CONFIG_AVAILABLE,\n    RateLimitAlgorithm,\n    RateLimitConfig,\n    RateLimitMiddleware,\n    RateLimitResult,\n    RateLimitRule,\n    RateLimitScope,\n    TenantQuota,\n    TenantQuotaProviderProtocol,\n    TenantRateLimitProvider,\n    create_rate_limit_middleware,\n)\nfrom .tenant_context import (\n    TENANT_ID_MAX_LENGTH,\n    TENANT_ID_MIN_LENGTH,\n    TENANT_ID_PATTERN,\n    TenantContextConfig,\n    TenantContextMiddleware,\n    TenantValidationError,\n    get_current_tenant_id,\n    get_optional_tenant_id,\n    get_tenant_id,\n    require_tenant_scope,\n    sanitize_tenant_id,\n    validate_tenant_id,\n)\n\n__all__ = [\n    # CORS\n    \"CORSConfig\",\n    \"CORSEnvironment\",\n    \"get_cors_config\",\n    \"get_strict_cors_config\",\n    \"detect_environment\",\n    \"validate_origin\",\n    \"DEFAULT_ORIGINS\",\n    # Rate Limiting\n    \"RateLimitMiddleware\",\n    \"RateLimitConfig\",\n    \"RateLimitRule\",\n    \"RateLimitResult\",\n    \"RateLimitScope\",\n    \"RateLimitAlgorithm\",\n    \"create_rate_limit_middleware\",\n    \"REDIS_AVAILABLE\",\n    # Tenant-specific Rate Limiting\n    \"TenantQuota\",\n    \"TenantRateLimitProvider\",\n    \"TenantQuotaProviderProtocol\",\n    \"TENANT_CONFIG_AVAILABLE\",\n    # Tenant Context\n    \"TenantContextMiddleware\",\n    \"TenantContextConfig\",\n    \"get_tenant_id\",\n    \"get_optional_tenant_id\",\n    \"get_current_tenant_id\",\n    \"validate_tenant_id\",\n    \"sanitize_tenant_id\",\n    \"require_tenant_scope\",\n    \"TenantValidationError\",\n    \"TENANT_ID_MAX_LENGTH\",\n    \"TENANT_ID_MIN_LENGTH\",\n    \"TENANT_ID_PATTERN\",\n]\n",
        "timestamp": "2026-01-03T19:07:31.669524"
      },
      "worktree_state": {
        "content": "\"\"\"\nACGS-2 Security Module\nConstitutional Hash: cdd01ef066bc6cf2\n\nCentralized security utilities for the ACGS-2 platform:\n- CORS configuration and validation\n- Rate limiting middleware\n- Tenant context middleware for multi-tenant isolation\n- API key and token management\n- Security headers enforcement\n\"\"\"\n\nfrom .cors_config import (\n    DEFAULT_ORIGINS,\n    CORSConfig,\n    CORSEnvironment,\n    detect_environment,\n    get_cors_config,\n    get_strict_cors_config,\n    validate_origin,\n)\nfrom .rate_limiter import (\n    REDIS_AVAILABLE,\n    TENANT_CONFIG_AVAILABLE,\n    RateLimitAlgorithm,\n    RateLimitConfig,\n    RateLimitMiddleware,\n    RateLimitResult,\n    RateLimitRule,\n    RateLimitScope,\n    TenantQuota,\n    TenantQuotaProviderProtocol,\n    TenantRateLimitProvider,\n    create_rate_limit_middleware,\n)\nfrom .security_headers import (\n    SecurityHeadersConfig,\n    SecurityHeadersMiddleware,\n    add_security_headers,\n)\nfrom .tenant_context import (\n    TENANT_ID_MAX_LENGTH,\n    TENANT_ID_MIN_LENGTH,\n    TENANT_ID_PATTERN,\n    TenantContextConfig,\n    TenantContextMiddleware,\n    TenantValidationError,\n    get_current_tenant_id,\n    get_optional_tenant_id,\n    get_tenant_id,\n    require_tenant_scope,\n    sanitize_tenant_id,\n    validate_tenant_id,\n)\n\n__all__ = [\n    # CORS\n    \"CORSConfig\",\n    \"CORSEnvironment\",\n    \"get_cors_config\",\n    \"get_strict_cors_config\",\n    \"detect_environment\",\n    \"validate_origin\",\n    \"DEFAULT_ORIGINS\",\n    # Rate Limiting\n    \"RateLimitMiddleware\",\n    \"RateLimitConfig\",\n    \"RateLimitRule\",\n    \"RateLimitResult\",\n    \"RateLimitScope\",\n    \"RateLimitAlgorithm\",\n    \"create_rate_limit_middleware\",\n    \"REDIS_AVAILABLE\",\n    # Tenant-specific Rate Limiting\n    \"TenantQuota\",\n    \"TenantRateLimitProvider\",\n    \"TenantQuotaProviderProtocol\",\n    \"TENANT_CONFIG_AVAILABLE\",\n    # Security Headers\n    \"SecurityHeadersMiddleware\",\n    \"SecurityHeadersConfig\",\n    \"add_security_headers\",\n    # Tenant Context\n    \"TenantContextMiddleware\",\n    \"TenantContextConfig\",\n    \"get_tenant_id\",\n    \"get_optional_tenant_id\",\n    \"get_current_tenant_id\",\n    \"validate_tenant_id\",\n    \"sanitize_tenant_id\",\n    \"require_tenant_scope\",\n    \"TenantValidationError\",\n    \"TENANT_ID_MAX_LENGTH\",\n    \"TENANT_ID_MIN_LENGTH\",\n    \"TENANT_ID_PATTERN\",\n]\n",
        "last_modified": "2026-01-03T19:08:32.488621"
      },
      "task_intent": {
        "title": "046-add-security-headers-middleware-to-fastapi-service",
        "description": "Multiple FastAPI services (integration-service, compliance-docs, observability dashboard) lack security headers middleware. Missing headers include Content-Security-Policy, X-Content-Type-Options, X-Frame-Options, Strict-Transport-Security, X-XSS-Protection, and Referrer-Policy.",
        "from_plan": true
      },
      "commits_behind_main": 11,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-03T19:07:31.741682",
  "last_updated": "2026-01-03T19:07:31.751360"
}