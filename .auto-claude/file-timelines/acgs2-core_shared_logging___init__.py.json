{
  "file_path": "src/core/shared/logging/__init__.py",
  "main_branch_history": [],
  "task_views": {
    "056-reduce-excessive-any-type-usage-in-python-codebase": {
      "task_id": "056-reduce-excessive-any-type-usage-in-python-codebase",
      "branch_point": {
        "commit_hash": "fc6e42927298263034acf989773f3200e422ad17",
        "content": "\"\"\"\nACGS-2 Logging Module\nConstitutional Hash: cdd01ef066bc6cf2\n\nCentralized logging utilities for the ACGS-2 platform:\n- Tenant-scoped audit logging with access controls\n- Structured logging for compliance and security\n- Audit trail for multi-tenant operations\n\"\"\"\n\nimport contextvars\nimport json\nimport logging\nfrom datetime import datetime, timezone\nfrom typing import Any, Callable, Optional\n\n# Context variable for correlation ID\n_correlation_id: contextvars.ContextVar[Optional[str]] = contextvars.ContextVar(\n    \"correlation_id\", default=None\n)\n\n\ndef get_logger(name: Optional[str] = None) -> logging.Logger:\n    \"\"\"\n    Get a configured logger instance.\n\n    Args:\n        name: Logger name. If None, returns root logger.\n\n    Returns:\n        Configured logging.Logger instance\n    \"\"\"\n    logger = logging.getLogger(name)\n    if not logger.handlers:\n        handler = logging.StreamHandler()\n        handler.setFormatter(\n            logging.Formatter(\n                '{\"timestamp\": \"%(asctime)s\", \"level\": \"%(levelname)s\", '\n                '\"logger\": \"%(name)s\", \"message\": \"%(message)s\"}'\n            )\n        )\n        logger.addHandler(handler)\n        logger.setLevel(logging.INFO)\n    return logger\n\n\ndef set_correlation_id(correlation_id: str) -> None:\n    \"\"\"Set the correlation ID for the current context.\"\"\"\n    _correlation_id.set(correlation_id)\n\n\ndef get_correlation_id() -> Optional[str]:\n    \"\"\"Get the correlation ID for the current context.\"\"\"\n    return _correlation_id.get()\n\n\ndef clear_correlation_id() -> None:\n    \"\"\"Clear the correlation ID for the current context.\"\"\"\n    _correlation_id.set(None)\n\n\nclass StructuredLogger:\n    \"\"\"Wrapper for structured logging with JSON output.\"\"\"\n\n    def __init__(self, name: str, service: str, json_format: bool = True):\n        self.name = name\n        self.service = service\n        self.json_format = json_format\n        self._logger = logging.getLogger(name)\n\n    def _log(self, level: str, event: str, **kwargs: Any) -> None:\n        \"\"\"Log a structured event.\"\"\"\n        record = {\n            \"timestamp\": datetime.now(timezone.utc).isoformat(),\n            \"level\": level,\n            \"service\": self.service,\n            \"event\": event,\n            **kwargs,\n        }\n        correlation_id = get_correlation_id()\n        if correlation_id:\n            record[\"correlation_id\"] = correlation_id\n\n        if self.json_format:\n            print(json.dumps(record))\n        else:\n            self._logger.log(getattr(logging, level), str(record))\n\n    def info(self, event: str, **kwargs: Any) -> None:\n        self._log(\"INFO\", event, **kwargs)\n\n    def warning(self, event: str, **kwargs: Any) -> None:\n        self._log(\"WARNING\", event, **kwargs)\n\n    def error(self, event: str, **kwargs: Any) -> None:\n        self._log(\"ERROR\", event, **kwargs)\n\n    def debug(self, event: str, **kwargs: Any) -> None:\n        self._log(\"DEBUG\", event, **kwargs)\n\n\ndef init_service_logging(\n    service_name: str,\n    level: str = \"INFO\",\n    json_format: bool = True,\n) -> StructuredLogger:\n    \"\"\"\n    Initialize structured logging for a service.\n\n    Args:\n        service_name: Name of the service for log identification\n        level: Logging level (DEBUG, INFO, WARNING, ERROR)\n        json_format: Whether to output logs in JSON format\n\n    Returns:\n        Configured StructuredLogger instance\n    \"\"\"\n    logging.basicConfig(level=getattr(logging, level))\n    return StructuredLogger(service_name, service_name, json_format)\n\n\ndef create_correlation_middleware() -> Callable:\n    \"\"\"\n    Create a FastAPI middleware for correlation ID propagation.\n\n    Returns:\n        Middleware function for FastAPI\n    \"\"\"\n\n    async def correlation_middleware(request: Any, call_next: Callable) -> Any:\n        import uuid\n\n        correlation_id = request.headers.get(\"X-Correlation-ID\", str(uuid.uuid4()))\n        set_correlation_id(correlation_id)\n        try:\n            response = await call_next(request)\n            response.headers[\"X-Correlation-ID\"] = correlation_id\n            return response\n        finally:\n            clear_correlation_id()\n\n    return correlation_middleware\n\n\nfrom .audit_logger import (AUDIT_LOGGER_AVAILABLE, AuditAction, AuditEntry,\n                           AuditLogConfig, AuditLogStore, AuditQueryParams,\n                           AuditQueryResult, AuditSeverity, InMemoryAuditStore,\n                           RedisAuditStore, TenantAuditLogger,\n                           create_tenant_audit_logger, get_tenant_audit_logger)\n\n__all__ = [\n    # Standard logger\n    \"get_logger\",\n    # Structured logging\n    \"init_service_logging\",\n    \"StructuredLogger\",\n    # Correlation ID\n    \"set_correlation_id\",\n    \"get_correlation_id\",\n    \"clear_correlation_id\",\n    \"create_correlation_middleware\",\n    # Main logger\n    \"TenantAuditLogger\",\n    \"create_tenant_audit_logger\",\n    \"get_tenant_audit_logger\",\n    # Configuration\n    \"AuditLogConfig\",\n    # Audit entries\n    \"AuditEntry\",\n    \"AuditAction\",\n    \"AuditSeverity\",\n    # Query\n    \"AuditQueryParams\",\n    \"AuditQueryResult\",\n    # Storage backends\n    \"AuditLogStore\",\n    \"InMemoryAuditStore\",\n    \"RedisAuditStore\",\n    # Feature flags\n    \"AUDIT_LOGGER_AVAILABLE\",\n]\n",
        "timestamp": "2026-01-04T05:35:58.374613"
      },
      "worktree_state": null,
      "task_intent": {
        "title": "056-reduce-excessive-any-type-usage-in-python-codebase",
        "description": "Found 373 occurrences of ': Any' type annotations across 120+ Python files, with high concentrations in integration-service (16 occurrences), src/core/breakthrough (79 occurrences), and src/core/enhanced_agent_bus (50+ occurrences). Excessive use of 'Any' defeats the purpose of type hints and can mask type-related bugs.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-03T19:36:18.087038",
  "last_updated": "2026-01-04T05:35:59.160399"
}