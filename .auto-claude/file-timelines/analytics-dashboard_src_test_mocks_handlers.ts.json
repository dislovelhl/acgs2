{
  "file_path": "analytics-dashboard/src/test/mocks/handlers.ts",
  "main_branch_history": [],
  "task_views": {
    "054-extract-duplicated-loadingstate-and-api-config-in-": {
      "task_id": "054-extract-duplicated-loadingstate-and-api-config-in-",
      "branch_point": {
        "commit_hash": "4a99fe22e8e0087919301b1aa185d4e2c6da716c",
        "content": "/**\n * MSW Request Handlers for Analytics API\n *\n * Defines mock responses for all analytics-api endpoints\n * used by the dashboard widgets during testing.\n */\n\nimport { http, HttpResponse } from \"msw\";\n\nconst API_BASE_URL = \"http://localhost:8080\";\n\n/** Sample insight data */\nconst mockInsightData = {\n  summary:\n    \"Governance compliance improved by 15% this week with reduced policy violations across all departments.\",\n  business_impact:\n    \"Lower violation rates indicate improved team awareness of governance policies, reducing potential compliance risks.\",\n  recommended_action:\n    \"Continue current training programs and consider extending to new team members.\",\n  confidence: 0.85,\n  generated_at: new Date().toISOString(),\n  model_used: \"gpt-4o\",\n  cached: false,\n};\n\n/** Sample anomalies data */\nconst mockAnomaliesData = {\n  analysis_timestamp: new Date().toISOString(),\n  total_records_analyzed: 150,\n  anomalies_detected: 3,\n  contamination_rate: 0.1,\n  model_trained: true,\n  anomalies: [\n    {\n      anomaly_id: \"anomaly-001\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.85,\n      severity_label: \"critical\" as const,\n      affected_metrics: {\n        violation_count: 45,\n        user_count: 12,\n        policy_changes: 3,\n      },\n      description: \"Unusual spike in policy violations detected\",\n    },\n    {\n      anomaly_id: \"anomaly-002\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.65,\n      severity_label: \"medium\" as const,\n      affected_metrics: {\n        violation_count: 22,\n        user_count: 5,\n      },\n      description: \"Moderate increase in access control violations\",\n    },\n    {\n      anomaly_id: \"anomaly-003\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.45,\n      severity_label: \"low\" as const,\n      affected_metrics: {\n        violation_count: 8,\n        user_count: 2,\n      },\n      description: \"Minor anomaly in user activity patterns\",\n    },\n  ],\n};\n\n/** Sample predictions data */\nconst mockPredictionsData = {\n  forecast_timestamp: new Date().toISOString(),\n  historical_days: 30,\n  forecast_days: 30,\n  model_trained: true,\n  predictions: Array.from({ length: 30 }, (_, i) => {\n    const date = new Date();\n    date.setDate(date.getDate() + i + 1);\n    const baseValue = 10 + Math.sin(i / 5) * 3;\n    return {\n      date: date.toISOString().split(\"T\")[0],\n      predicted_value: baseValue,\n      lower_bound: baseValue - 2,\n      upper_bound: baseValue + 2,\n      trend: i < 15 ? 0.1 : -0.05,\n    };\n  }),\n  summary: {\n    status: \"success\",\n    mean_predicted_violations: 10.5,\n    max_predicted_violations: 13.2,\n    min_predicted_violations: 7.8,\n    total_predicted_violations: 315,\n    trend_direction: \"stable\",\n    reason: null,\n  },\n  error_message: null,\n};\n\n/** Sample query response */\nconst mockQueryResponse = {\n  query: \"Show violations this week\",\n  answer:\n    \"There were 23 policy violations this week, a 15% decrease from last week. The most common violation type was access control (12 incidents), followed by data handling (8 incidents).\",\n  data: {\n    total_violations: 23,\n    violation_types: [\"access_control\", \"data_handling\", \"authentication\"],\n    top_policies: [\"policy-auth-001\", \"policy-data-002\"],\n    trend: \"decreasing\",\n  },\n  query_understood: true,\n  generated_at: new Date().toISOString(),\n};\n\n/**\n * MSW handlers for all analytics API endpoints\n */\nexport const handlers = [\n  // GET /insights\n  http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(mockInsightData);\n  }),\n\n  // GET /insights/status\n  http.get(`${API_BASE_URL}/insights/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"insights\" });\n  }),\n\n  // GET /anomalies\n  http.get(`${API_BASE_URL}/anomalies`, ({ request }) => {\n    const url = new URL(request.url);\n    const severity = url.searchParams.get(\"severity\");\n\n    if (severity) {\n      const filteredAnomalies = {\n        ...mockAnomaliesData,\n        anomalies: mockAnomaliesData.anomalies.filter(\n          (a) => a.severity_label === severity\n        ),\n      };\n      filteredAnomalies.anomalies_detected = filteredAnomalies.anomalies.length;\n      return HttpResponse.json(filteredAnomalies);\n    }\n\n    return HttpResponse.json(mockAnomaliesData);\n  }),\n\n  // GET /anomalies/status\n  http.get(`${API_BASE_URL}/anomalies/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"anomalies\" });\n  }),\n\n  // GET /predictions\n  http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(mockPredictionsData);\n  }),\n\n  // GET /predictions/status\n  http.get(`${API_BASE_URL}/predictions/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"predictions\" });\n  }),\n\n  // POST /query\n  http.post(`${API_BASE_URL}/query`, async ({ request }) => {\n    const body = await request.json();\n    const question =\n      typeof body === \"object\" && body !== null && \"question\" in body\n        ? (body as { question: string }).question\n        : \"\";\n\n    return HttpResponse.json({\n      ...mockQueryResponse,\n      query: question,\n    });\n  }),\n\n  // POST /export/pdf\n  http.post(`${API_BASE_URL}/export/pdf`, () => {\n    // Return a mock PDF blob\n    const pdfContent = new Uint8Array([\n      0x25, 0x50, 0x44, 0x46, // %PDF header\n      0x2d, 0x31, 0x2e, 0x34, // -1.4\n    ]);\n    return new HttpResponse(pdfContent, {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\":\n          'attachment; filename=\"governance_report.pdf\"',\n      },\n    });\n  }),\n\n  // GET /export/status\n  http.get(`${API_BASE_URL}/export/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"export\" });\n  }),\n\n  // Health check endpoint\n  http.get(`${API_BASE_URL}/health`, () => {\n    return HttpResponse.json({\n      status: \"healthy\",\n      version: \"1.0.0\",\n      services: [\"insights\", \"anomalies\", \"predictions\", \"query\", \"export\"],\n    });\n  }),\n];\n\n/**\n * Error handlers for testing error states\n */\nexport const errorHandlers = {\n  insightsError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(\n      { detail: \"Failed to generate insights\" },\n      { status: 500 }\n    );\n  }),\n\n  anomaliesError: http.get(`${API_BASE_URL}/anomalies`, () => {\n    return HttpResponse.json(\n      { detail: \"Anomaly detection service unavailable\" },\n      { status: 503 }\n    );\n  }),\n\n  predictionsError: http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(\n      { detail: \"Insufficient data for predictions\" },\n      { status: 400 }\n    );\n  }),\n\n  queryError: http.post(`${API_BASE_URL}/query`, () => {\n    return HttpResponse.json(\n      { detail: \"Query processing failed\" },\n      { status: 500 }\n    );\n  }),\n\n  networkError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.error();\n  }),\n};\n",
        "timestamp": "2026-01-03T18:35:24.567548"
      },
      "worktree_state": {
        "content": "/**\n * MSW Request Handlers for Analytics API\n *\n * Defines mock responses for all analytics-api endpoints\n * used by the dashboard widgets during testing.\n */\n\nimport { http, HttpResponse } from \"msw\";\nimport { API_BASE_URL } from \"../../lib\";\n\n/** Sample insight data */\nconst mockInsightData = {\n  summary:\n    \"Governance compliance improved by 15% this week with reduced policy violations across all departments.\",\n  business_impact:\n    \"Lower violation rates indicate improved team awareness of governance policies, reducing potential compliance risks.\",\n  recommended_action:\n    \"Continue current training programs and consider extending to new team members.\",\n  confidence: 0.85,\n  generated_at: new Date().toISOString(),\n  model_used: \"gpt-4o\",\n  cached: false,\n};\n\n/** Sample anomalies data */\nconst mockAnomaliesData = {\n  analysis_timestamp: new Date().toISOString(),\n  total_records_analyzed: 150,\n  anomalies_detected: 3,\n  contamination_rate: 0.1,\n  model_trained: true,\n  anomalies: [\n    {\n      anomaly_id: \"anomaly-001\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.85,\n      severity_label: \"critical\" as const,\n      affected_metrics: {\n        violation_count: 45,\n        user_count: 12,\n        policy_changes: 3,\n      },\n      description: \"Unusual spike in policy violations detected\",\n    },\n    {\n      anomaly_id: \"anomaly-002\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.65,\n      severity_label: \"medium\" as const,\n      affected_metrics: {\n        violation_count: 22,\n        user_count: 5,\n      },\n      description: \"Moderate increase in access control violations\",\n    },\n    {\n      anomaly_id: \"anomaly-003\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.45,\n      severity_label: \"low\" as const,\n      affected_metrics: {\n        violation_count: 8,\n        user_count: 2,\n      },\n      description: \"Minor anomaly in user activity patterns\",\n    },\n  ],\n};\n\n/** Sample predictions data */\nconst mockPredictionsData = {\n  forecast_timestamp: new Date().toISOString(),\n  historical_days: 30,\n  forecast_days: 30,\n  model_trained: true,\n  predictions: Array.from({ length: 30 }, (_, i) => {\n    const date = new Date();\n    date.setDate(date.getDate() + i + 1);\n    const baseValue = 10 + Math.sin(i / 5) * 3;\n    return {\n      date: date.toISOString().split(\"T\")[0],\n      predicted_value: baseValue,\n      lower_bound: baseValue - 2,\n      upper_bound: baseValue + 2,\n      trend: i < 15 ? 0.1 : -0.05,\n    };\n  }),\n  summary: {\n    status: \"success\",\n    mean_predicted_violations: 10.5,\n    max_predicted_violations: 13.2,\n    min_predicted_violations: 7.8,\n    total_predicted_violations: 315,\n    trend_direction: \"stable\",\n    reason: null,\n  },\n  error_message: null,\n};\n\n/** Sample query response */\nconst mockQueryResponse = {\n  query: \"Show violations this week\",\n  answer:\n    \"There were 23 policy violations this week, a 15% decrease from last week. The most common violation type was access control (12 incidents), followed by data handling (8 incidents).\",\n  data: {\n    total_violations: 23,\n    violation_types: [\"access_control\", \"data_handling\", \"authentication\"],\n    top_policies: [\"policy-auth-001\", \"policy-data-002\"],\n    trend: \"decreasing\",\n  },\n  query_understood: true,\n  generated_at: new Date().toISOString(),\n};\n\n/**\n * MSW handlers for all analytics API endpoints\n */\nexport const handlers = [\n  // GET /insights\n  http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(mockInsightData);\n  }),\n\n  // GET /insights/status\n  http.get(`${API_BASE_URL}/insights/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"insights\" });\n  }),\n\n  // GET /anomalies\n  http.get(`${API_BASE_URL}/anomalies`, ({ request }) => {\n    const url = new URL(request.url);\n    const severity = url.searchParams.get(\"severity\");\n\n    if (severity) {\n      const filteredAnomalies = {\n        ...mockAnomaliesData,\n        anomalies: mockAnomaliesData.anomalies.filter(\n          (a) => a.severity_label === severity\n        ),\n      };\n      filteredAnomalies.anomalies_detected = filteredAnomalies.anomalies.length;\n      return HttpResponse.json(filteredAnomalies);\n    }\n\n    return HttpResponse.json(mockAnomaliesData);\n  }),\n\n  // GET /anomalies/status\n  http.get(`${API_BASE_URL}/anomalies/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"anomalies\" });\n  }),\n\n  // GET /predictions\n  http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(mockPredictionsData);\n  }),\n\n  // GET /predictions/status\n  http.get(`${API_BASE_URL}/predictions/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"predictions\" });\n  }),\n\n  // POST /query\n  http.post(`${API_BASE_URL}/query`, async ({ request }) => {\n    const body = await request.json();\n    const question =\n      typeof body === \"object\" && body !== null && \"question\" in body\n        ? (body as { question: string }).question\n        : \"\";\n\n    return HttpResponse.json({\n      ...mockQueryResponse,\n      query: question,\n    });\n  }),\n\n  // POST /export/pdf\n  http.post(`${API_BASE_URL}/export/pdf`, () => {\n    // Return a mock PDF blob\n    const pdfContent = new Uint8Array([\n      0x25, 0x50, 0x44, 0x46, // %PDF header\n      0x2d, 0x31, 0x2e, 0x34, // -1.4\n    ]);\n    return new HttpResponse(pdfContent, {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\":\n          'attachment; filename=\"governance_report.pdf\"',\n      },\n    });\n  }),\n\n  // GET /export/status\n  http.get(`${API_BASE_URL}/export/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"export\" });\n  }),\n\n  // Health check endpoint\n  http.get(`${API_BASE_URL}/health`, () => {\n    return HttpResponse.json({\n      status: \"healthy\",\n      version: \"1.0.0\",\n      services: [\"insights\", \"anomalies\", \"predictions\", \"query\", \"export\"],\n    });\n  }),\n];\n\n/**\n * Error handlers for testing error states\n */\nexport const errorHandlers = {\n  insightsError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(\n      { detail: \"Failed to generate insights\" },\n      { status: 500 }\n    );\n  }),\n\n  anomaliesError: http.get(`${API_BASE_URL}/anomalies`, () => {\n    return HttpResponse.json(\n      { detail: \"Anomaly detection service unavailable\" },\n      { status: 503 }\n    );\n  }),\n\n  predictionsError: http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(\n      { detail: \"Insufficient data for predictions\" },\n      { status: 400 }\n    );\n  }),\n\n  queryError: http.post(`${API_BASE_URL}/query`, () => {\n    return HttpResponse.json(\n      { detail: \"Query processing failed\" },\n      { status: 500 }\n    );\n  }),\n\n  networkError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.error();\n  }),\n};\n",
        "last_modified": "2026-01-03T19:10:12.026464"
      },
      "task_intent": {
        "title": "054-extract-duplicated-loadingstate-and-api-config-in-",
        "description": "The analytics-dashboard has 4 widget components (PredictionWidget, AnomalyWidget, InsightWidget, QueryInterface) that each independently define the same LoadingState type and API_BASE_URL constant. This pattern is repeated across 7+ files when including tests, leading to maintenance burden and potential inconsistencies.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    },
    "034-add-compliancewidget-to-analytics-dashboard": {
      "task_id": "034-add-compliancewidget-to-analytics-dashboard",
      "branch_point": {
        "commit_hash": "fc6e42927298263034acf989773f3200e422ad17",
        "content": "/**\n * MSW Request Handlers for Analytics API\n *\n * Defines mock responses for all analytics-api endpoints\n * used by the dashboard widgets during testing.\n */\n\nimport { http, HttpResponse } from \"msw\";\nimport { API_BASE_URL } from \"../../lib\";\n\n/** Sample insight data */\nconst mockInsightData = {\n  summary:\n    \"Governance compliance improved by 15% this week with reduced policy violations across all departments.\",\n  business_impact:\n    \"Lower violation rates indicate improved team awareness of governance policies, reducing potential compliance risks.\",\n  recommended_action:\n    \"Continue current training programs and consider extending to new team members.\",\n  confidence: 0.85,\n  generated_at: new Date().toISOString(),\n  model_used: \"gpt-4o\",\n  cached: false,\n};\n\n/** Sample anomalies data */\nconst mockAnomaliesData = {\n  analysis_timestamp: new Date().toISOString(),\n  total_records_analyzed: 150,\n  anomalies_detected: 3,\n  contamination_rate: 0.1,\n  model_trained: true,\n  anomalies: [\n    {\n      anomaly_id: \"anomaly-001\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.85,\n      severity_label: \"critical\" as const,\n      affected_metrics: {\n        violation_count: 45,\n        user_count: 12,\n        policy_changes: 3,\n      },\n      description: \"Unusual spike in policy violations detected\",\n    },\n    {\n      anomaly_id: \"anomaly-002\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.65,\n      severity_label: \"medium\" as const,\n      affected_metrics: {\n        violation_count: 22,\n        user_count: 5,\n      },\n      description: \"Moderate increase in access control violations\",\n    },\n    {\n      anomaly_id: \"anomaly-003\",\n      timestamp: new Date().toISOString(),\n      severity_score: 0.45,\n      severity_label: \"low\" as const,\n      affected_metrics: {\n        violation_count: 8,\n        user_count: 2,\n      },\n      description: \"Minor anomaly in user activity patterns\",\n    },\n  ],\n};\n\n/** Sample predictions data */\nconst mockPredictionsData = {\n  forecast_timestamp: new Date().toISOString(),\n  historical_days: 30,\n  forecast_days: 30,\n  model_trained: true,\n  predictions: Array.from({ length: 30 }, (_, i) => {\n    const date = new Date();\n    date.setDate(date.getDate() + i + 1);\n    const baseValue = 10 + Math.sin(i / 5) * 3;\n    return {\n      date: date.toISOString().split(\"T\")[0],\n      predicted_value: baseValue,\n      lower_bound: baseValue - 2,\n      upper_bound: baseValue + 2,\n      trend: i < 15 ? 0.1 : -0.05,\n    };\n  }),\n  summary: {\n    status: \"success\",\n    mean_predicted_violations: 10.5,\n    max_predicted_violations: 13.2,\n    min_predicted_violations: 7.8,\n    total_predicted_violations: 315,\n    trend_direction: \"stable\",\n    reason: null,\n  },\n  error_message: null,\n};\n\n/** Sample query response */\nconst mockQueryResponse = {\n  query: \"Show violations this week\",\n  answer:\n    \"There were 23 policy violations this week, a 15% decrease from last week. The most common violation type was access control (12 incidents), followed by data handling (8 incidents).\",\n  data: {\n    total_violations: 23,\n    violation_types: [\"access_control\", \"data_handling\", \"authentication\"],\n    top_policies: [\"policy-auth-001\", \"policy-data-002\"],\n    trend: \"decreasing\",\n  },\n  query_understood: true,\n  generated_at: new Date().toISOString(),\n};\n\n/** Sample compliance data */\nconst mockComplianceData = {\n  analysis_timestamp: new Date().toISOString(),\n  overall_score: 84.5,\n  trend: \"improving\" as const,\n  violations_by_severity: {\n    critical: 2,\n    high: 5,\n    medium: 8,\n    low: 12,\n  },\n  total_violations: 27,\n  recent_violations: [\n    {\n      id: \"comp-001\",\n      rule: \"Sensitive data must be encrypted at rest\",\n      severity: \"critical\" as const,\n      description: \"Unencrypted PII detected in production database\",\n      timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),\n      framework: \"SOC2\",\n      evidence: {\n        database: \"users_prod\",\n        field: \"ssn\",\n        encryption_status: \"none\",\n      },\n    },\n    {\n      id: \"comp-002\",\n      rule: \"API access requires multi-factor authentication\",\n      severity: \"high\" as const,\n      description: \"Admin API endpoint accessible without MFA\",\n      timestamp: new Date(Date.now() - 5 * 60 * 60 * 1000).toISOString(),\n      framework: \"HIPAA\",\n      evidence: {\n        endpoint: \"/admin/users\",\n        mfa_enabled: false,\n      },\n    },\n    {\n      id: \"comp-003\",\n      rule: \"Security patches must be applied within 30 days\",\n      severity: \"medium\" as const,\n      description: \"Critical security patch overdue by 12 days\",\n      timestamp: new Date(Date.now() - 12 * 60 * 60 * 1000).toISOString(),\n      framework: \"PCI-DSS\",\n      evidence: {\n        package: \"openssl\",\n        current_version: \"1.1.1k\",\n        required_version: \"1.1.1w\",\n        days_overdue: 12,\n      },\n    },\n    {\n      id: \"comp-004\",\n      rule: \"Access logs must be retained for 90 days\",\n      severity: \"low\" as const,\n      description: \"Log retention policy set to 60 days\",\n      timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),\n      framework: \"SOC2\",\n    },\n    {\n      id: \"comp-005\",\n      rule: \"Failed login attempts must trigger alerts\",\n      severity: \"medium\" as const,\n      description: \"Alert threshold set too high (50 attempts)\",\n      timestamp: new Date(Date.now() - 36 * 60 * 60 * 1000).toISOString(),\n      framework: \"HIPAA\",\n      evidence: {\n        current_threshold: 50,\n        recommended_threshold: 10,\n      },\n    },\n  ],\n  frameworks_analyzed: [\"SOC2\", \"HIPAA\", \"PCI-DSS\", \"GDPR\"],\n};\n\n/**\n * MSW handlers for all analytics API endpoints\n */\nexport const handlers = [\n  // GET /insights\n  http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(mockInsightData);\n  }),\n\n  // GET /insights/status\n  http.get(`${API_BASE_URL}/insights/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"insights\" });\n  }),\n\n  // GET /anomalies\n  http.get(`${API_BASE_URL}/anomalies`, ({ request }) => {\n    const url = new URL(request.url);\n    const severity = url.searchParams.get(\"severity\");\n\n    if (severity) {\n      const filteredAnomalies = {\n        ...mockAnomaliesData,\n        anomalies: mockAnomaliesData.anomalies.filter(\n          (a) => a.severity_label === severity\n        ),\n      };\n      filteredAnomalies.anomalies_detected = filteredAnomalies.anomalies.length;\n      return HttpResponse.json(filteredAnomalies);\n    }\n\n    return HttpResponse.json(mockAnomaliesData);\n  }),\n\n  // GET /anomalies/status\n  http.get(`${API_BASE_URL}/anomalies/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"anomalies\" });\n  }),\n\n  // GET /predictions\n  http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(mockPredictionsData);\n  }),\n\n  // GET /predictions/status\n  http.get(`${API_BASE_URL}/predictions/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"predictions\" });\n  }),\n\n  // GET /compliance\n  http.get(`${API_BASE_URL}/compliance`, ({ request }) => {\n    const url = new URL(request.url);\n    const severity = url.searchParams.get(\"severity\");\n\n    if (severity) {\n      const filteredViolations = {\n        ...mockComplianceData,\n        recent_violations: mockComplianceData.recent_violations.filter(\n          (v) => v.severity === severity\n        ),\n      };\n      return HttpResponse.json(filteredViolations);\n    }\n\n    return HttpResponse.json(mockComplianceData);\n  }),\n\n  // POST /query\n  http.post(`${API_BASE_URL}/query`, async ({ request }) => {\n    const body = await request.json();\n    const question =\n      typeof body === \"object\" && body !== null && \"question\" in body\n        ? (body as { question: string }).question\n        : \"\";\n\n    return HttpResponse.json({\n      ...mockQueryResponse,\n      query: question,\n    });\n  }),\n\n  // POST /export/pdf\n  http.post(`${API_BASE_URL}/export/pdf`, () => {\n    // Return a mock PDF blob\n    const pdfContent = new Uint8Array([\n      0x25, 0x50, 0x44, 0x46, // %PDF header\n      0x2d, 0x31, 0x2e, 0x34, // -1.4\n    ]);\n    return new HttpResponse(pdfContent, {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\":\n          'attachment; filename=\"governance_report.pdf\"',\n      },\n    });\n  }),\n\n  // GET /export/status\n  http.get(`${API_BASE_URL}/export/status`, () => {\n    return HttpResponse.json({ status: \"healthy\", service: \"export\" });\n  }),\n\n  // Health check endpoint\n  http.get(`${API_BASE_URL}/health`, () => {\n    return HttpResponse.json({\n      status: \"healthy\",\n      version: \"1.0.0\",\n      services: [\"insights\", \"anomalies\", \"predictions\", \"query\", \"export\"],\n    });\n  }),\n];\n\n/**\n * Error handlers for testing error states\n */\nexport const errorHandlers = {\n  insightsError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.json(\n      { detail: \"Failed to generate insights\" },\n      { status: 500 }\n    );\n  }),\n\n  anomaliesError: http.get(`${API_BASE_URL}/anomalies`, () => {\n    return HttpResponse.json(\n      { detail: \"Anomaly detection service unavailable\" },\n      { status: 503 }\n    );\n  }),\n\n  predictionsError: http.get(`${API_BASE_URL}/predictions`, () => {\n    return HttpResponse.json(\n      { detail: \"Insufficient data for predictions\" },\n      { status: 400 }\n    );\n  }),\n\n  complianceError: http.get(`${API_BASE_URL}/compliance`, () => {\n    return HttpResponse.json(\n      { detail: \"Compliance service unavailable\" },\n      { status: 503 }\n    );\n  }),\n\n  queryError: http.post(`${API_BASE_URL}/query`, () => {\n    return HttpResponse.json(\n      { detail: \"Query processing failed\" },\n      { status: 500 }\n    );\n  }),\n\n  networkError: http.get(`${API_BASE_URL}/insights`, () => {\n    return HttpResponse.error();\n  }),\n};\n",
        "timestamp": "2026-01-04T05:36:41.954466"
      },
      "worktree_state": null,
      "task_intent": {
        "title": "034-add-compliancewidget-to-analytics-dashboard",
        "description": "Create a ComplianceWidget component showing real-time compliance status, compliance rate trends, and policy violation summaries. Follows the established widget pattern with loading/error/empty states, severity coloring, and refresh functionality.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-03T18:35:24.612927",
  "last_updated": "2026-01-04T05:36:42.010064"
}