{
  "file_path": "src/core/services/compliance_docs/src/main.py",
  "main_branch_history": [],
  "task_views": {
    "046-add-security-headers-middleware-to-fastapi-service": {
      "task_id": "046-add-security-headers-middleware-to-fastapi-service",
      "branch_point": {
        "commit_hash": "4a99fe22e8e0087919301b1aa185d4e2c6da716c",
        "content": "\"\"\"Constitutional Hash: cdd01ef066bc6cf2\nACGS-2 Compliance Documentation Service\nGenerates compliance documentation and evidence exports for SOC 2, ISO 27001, GDPR, and EU AI Act\n\"\"\"\n\nimport logging\nfrom datetime import datetime, timezone\n\nfrom fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\n# Configure logging\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\napp = FastAPI(\n    title=\"ACGS-2 Compliance Documentation Service\",\n    description=\"Enterprise compliance documentation and evidence export service\",\n    version=\"1.0.0\",\n)\n\n# Add CORS middleware (configure based on environment)\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],  # TODO: Configure based on environment\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n\n# Health check endpoints\n@app.get(\"/health\")\nasync def health_check():\n    \"\"\"Health check endpoint\"\"\"\n    return {\n        \"status\": \"healthy\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat()\n    }\n\n\n@app.get(\"/ready\")\nasync def readiness_check():\n    \"\"\"Readiness check endpoint\"\"\"\n    return {\n        \"status\": \"ready\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat()\n    }\n\n\n# Import API routers\ntry:\n    from .api.euaiact_routes import router as euaiact_router\n    app.include_router(euaiact_router)\nexcept ImportError as e:\n    logger.warning(f\"Failed to import EU AI Act routes: {e}\")\n\n# API v1 router will be added here\n@app.get(\"/\")\nasync def root():\n    \"\"\"Root endpoint\"\"\"\n    return {\n        \"service\": \"compliance-docs-service\",\n        \"version\": \"1.0.0\",\n        \"description\": \"Enterprise compliance documentation and evidence export service\",\n        \"endpoints\": {\n            \"health\": \"/health\",\n            \"ready\": \"/ready\",\n            \"api\": \"/api/v1/\",\n            \"euaiact\": \"/api/v1/euaiact/\",\n        },\n    }\n\n\nif __name__ == \"__main__\":\n    import uvicorn\n\n    uvicorn.run(\"main:app\", host=\"0.0.0.0\", port=8100, reload=True, log_level=\"info\")\n",
        "timestamp": "2026-01-03T19:07:31.669524"
      },
      "worktree_state": {
        "content": "\"\"\"Constitutional Hash: cdd01ef066bc6cf2\nACGS-2 Compliance Documentation Service\nGenerates compliance documentation and evidence exports for SOC 2, ISO 27001, GDPR, and EU AI Act\n\"\"\"\n\nimport logging\nimport os\nimport sys\nfrom datetime import datetime, timezone\nfrom pathlib import Path\n\nfrom fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\n# Add src/core to path for shared modules\ncore_path = Path(__file__).parent.parent.parent.parent\nif str(core_path) not in sys.path:\n    sys.path.insert(0, str(core_path))\n\nfrom shared.security import SecurityHeadersConfig, SecurityHeadersMiddleware\n\n# Configure logging\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n# Environment configuration\nENVIRONMENT = os.getenv(\"APP_ENV\", \"production\")\n\napp = FastAPI(\n    title=\"ACGS-2 Compliance Documentation Service\",\n    description=\"Enterprise compliance documentation and evidence export service\",\n    version=\"1.0.0\",\n)\n\n# Add CORS middleware (configure based on environment)\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],  # TODO: Configure based on environment\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n# Add security headers middleware\n# Configure strict CSP for documentation service with production-grade HSTS\nsecurity_config = SecurityHeadersConfig.for_production(strict=True)\napp.add_middleware(SecurityHeadersMiddleware, config=security_config)\nlogger.info(\n    f\"Security headers middleware configured for compliance-docs service (environment: {ENVIRONMENT})\"\n)\n\n\n# Health check endpoints\n@app.get(\"/health\")\nasync def health_check():\n    \"\"\"Health check endpoint\"\"\"\n    return {\n        \"status\": \"healthy\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/ready\")\nasync def readiness_check():\n    \"\"\"Readiness check endpoint\"\"\"\n    return {\n        \"status\": \"ready\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n# Import API routers\ntry:\n    from .api.euaiact_routes import router as euaiact_router\n\n    app.include_router(euaiact_router)\nexcept ImportError as e:\n    logger.warning(f\"Failed to import EU AI Act routes: {e}\")\n\n\n# API v1 router will be added here\n@app.get(\"/\")\nasync def root():\n    \"\"\"Root endpoint\"\"\"\n    return {\n        \"service\": \"compliance-docs-service\",\n        \"version\": \"1.0.0\",\n        \"description\": \"Enterprise compliance documentation and evidence export service\",\n        \"endpoints\": {\n            \"health\": \"/health\",\n            \"ready\": \"/ready\",\n            \"api\": \"/api/v1/\",\n            \"euaiact\": \"/api/v1/euaiact/\",\n        },\n    }\n\n\nif __name__ == \"__main__\":\n    import uvicorn\n\n    uvicorn.run(\"main:app\", host=\"0.0.0.0\", port=8100, reload=True, log_level=\"info\")\n",
        "last_modified": "2026-01-03T19:08:32.487653"
      },
      "task_intent": {
        "title": "046-add-security-headers-middleware-to-fastapi-service",
        "description": "Multiple FastAPI services (integration-service, compliance-docs, observability dashboard) lack security headers middleware. Missing headers include Content-Security-Policy, X-Content-Type-Options, X-Frame-Options, Strict-Transport-Security, X-XSS-Protection, and Referrer-Policy.",
        "from_plan": true
      },
      "commits_behind_main": 11,
      "status": "active",
      "merged_at": null
    },
    "060-document-error-codes-and-troubleshooting-for-commo": {
      "task_id": "060-document-error-codes-and-troubleshooting-for-commo",
      "branch_point": {
        "commit_hash": "fc6e42927298263034acf989773f3200e422ad17",
        "content": "\"\"\"Constitutional Hash: cdd01ef066bc6cf2\nACGS-2 Compliance Documentation Service\nGenerates compliance documentation and evidence exports for SOC 2, ISO 27001, GDPR, and EU AI Act\n\"\"\"\n\nimport logging\nimport os\nimport sys\nfrom datetime import datetime, timezone\nfrom pathlib import Path\n\nfrom fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\n# Add src/core to path for shared modules\ncore_path = Path(__file__).parent.parent.parent.parent\nif str(core_path) not in sys.path:\n    sys.path.insert(0, str(core_path))\n\nfrom shared.security import SecurityHeadersConfig, SecurityHeadersMiddleware\nfrom shared.security.cors_config import get_cors_config\n# Configure logging\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\n# Environment configuration\nENVIRONMENT = os.getenv(\"APP_ENV\", \"production\")\n\napp = FastAPI(\n    title=\"ACGS-2 Compliance Documentation Service\",\n    description=\"Enterprise compliance documentation and evidence export service\",\n    version=\"1.0.0\",\n)\n\n# Add CORS middleware (configured based on environment)\napp.add_middleware(CORSMiddleware, **get_cors_config())\n\n# Add security headers middleware\n# Configure strict CSP for documentation service with production-grade HSTS\nsecurity_config = SecurityHeadersConfig.for_production(strict=True)\napp.add_middleware(SecurityHeadersMiddleware, config=security_config)\nlogger.info(\n    f\"Security headers middleware configured for compliance-docs service (environment: {ENVIRONMENT})\"\n)\n\n\n# Health check endpoints\n@app.get(\"/health\")\nasync def health_check():\n    \"\"\"Health check endpoint\"\"\"\n    return {\n        \"status\": \"healthy\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/ready\")\nasync def readiness_check():\n    \"\"\"Readiness check endpoint\"\"\"\n    return {\n        \"status\": \"ready\",\n        \"service\": \"compliance-docs-service\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n# Import API routers\ntry:\n    from .api.euaiact_routes import router as euaiact_router\n\n    app.include_router(euaiact_router)\nexcept ImportError as e:\n    logger.warning(f\"Failed to import EU AI Act routes: {e}\")\n\n\n# API v1 router will be added here\n@app.get(\"/\")\nasync def root():\n    \"\"\"Root endpoint\"\"\"\n    return {\n        \"service\": \"compliance-docs-service\",\n        \"version\": \"1.0.0\",\n        \"description\": \"Enterprise compliance documentation and evidence export service\",\n        \"endpoints\": {\n            \"health\": \"/health\",\n            \"ready\": \"/ready\",\n            \"api\": \"/api/v1/\",\n            \"euaiact\": \"/api/v1/euaiact/\",\n        },\n    }\n\n\nif __name__ == \"__main__\":\n    import uvicorn\n\n    uvicorn.run(\"main:app\", host=\"0.0.0.0\", port=8100, reload=True, log_level=\"info\")\n",
        "timestamp": "2026-01-04T05:35:51.134105"
      },
      "worktree_state": null,
      "task_intent": {
        "title": "060-document-error-codes-and-troubleshooting-for-commo",
        "description": "The codebase has 13 TODO/FIXME comments across critical files including webhooks.py, approval_chain_engine.py, and config_validator.py. Additionally, there's no centralized documentation for error codes, failure modes, or troubleshooting guides. Users encountering errors have no reference for resolution.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-03T19:07:31.709749",
  "last_updated": "2026-01-04T05:35:51.246418"
}