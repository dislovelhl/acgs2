{
  "file_path": "integration-service/src/config.py",
  "main_branch_history": [],
  "task_views": {
    "001-connect-your-tools": {
      "task_id": "001-connect-your-tools",
      "branch_point": {
        "commit_hash": "cc53a509f89115bbb36940c140031e6159320791",
        "content": "",
        "timestamp": "2026-01-03T17:00:01.335551"
      },
      "worktree_state": {
        "content": "\"\"\"\nLinear integration configuration using pydantic-settings.\n\nLoads Linear API credentials and settings from environment variables\nwith type validation and secure credential handling.\n\"\"\"\n\nfrom typing import Optional\n\nfrom pydantic import Field, SecretStr\nfrom pydantic_settings import BaseSettings, SettingsConfigDict\n\n\nclass LinearConfig(BaseSettings):\n    \"\"\"\n    Configuration for Linear integration.\n\n    Loads Linear API credentials and settings from environment variables.\n    All sensitive fields (API keys, secrets) use SecretStr for secure handling.\n    \"\"\"\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        case_sensitive=True,\n        extra=\"ignore\",\n    )\n\n    # Authentication\n    linear_api_key: SecretStr = Field(\n        ...,\n        description=\"Linear API key (get from Linear Settings > API)\",\n        json_schema_extra={\"env\": \"LINEAR_API_KEY\"},\n    )\n\n    linear_webhook_secret: SecretStr = Field(\n        ...,\n        description=\"Secret for verifying Linear webhook signatures (HMAC-SHA256)\",\n        json_schema_extra={\"env\": \"LINEAR_WEBHOOK_SECRET\"},\n    )\n\n    # Linear team and project settings\n    linear_team_id: str = Field(\n        ...,\n        description=\"Default Linear team ID for issue creation\",\n        json_schema_extra={\"env\": \"LINEAR_TEAM_ID\"},\n    )\n\n    linear_project_id: Optional[str] = Field(\n        default=None,\n        description=\"Optional default Linear project ID\",\n        json_schema_extra={\"env\": \"LINEAR_PROJECT_ID\"},\n    )\n\n    # Linear API endpoint\n    linear_api_url: str = Field(\n        default=\"https://api.linear.app/graphql\",\n        description=\"Linear GraphQL API endpoint\",\n        json_schema_extra={\"env\": \"LINEAR_API_URL\"},\n    )\n\n    # Request timeout and retry settings\n    linear_timeout_seconds: float = Field(\n        default=30.0,\n        ge=1.0,\n        le=300.0,\n        description=\"Request timeout for Linear API calls in seconds\",\n        json_schema_extra={\"env\": \"LINEAR_TIMEOUT_SECONDS\"},\n    )\n\n    linear_max_retries: int = Field(\n        default=3,\n        ge=0,\n        le=10,\n        description=\"Maximum retry attempts for failed Linear API calls\",\n        json_schema_extra={\"env\": \"LINEAR_MAX_RETRIES\"},\n    )\n\n\nclass SlackConfig(BaseSettings):\n    \"\"\"\n    Configuration for Slack integration (used for Linear notifications).\n\n    Loads Slack credentials and settings from environment variables.\n    \"\"\"\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        case_sensitive=True,\n        extra=\"ignore\",\n    )\n\n    # Authentication\n    slack_bot_token: Optional[SecretStr] = Field(\n        default=None,\n        description=\"Slack Bot User OAuth Token (starts with xoxb-)\",\n        json_schema_extra={\"env\": \"SLACK_BOT_TOKEN\"},\n    )\n\n    slack_signing_secret: Optional[SecretStr] = Field(\n        default=None,\n        description=\"Slack app signing secret for webhook verification\",\n        json_schema_extra={\"env\": \"SLACK_SIGNING_SECRET\"},\n    )\n\n    # Channel settings\n    slack_default_channel: Optional[str] = Field(\n        default=None,\n        description=\"Default Slack channel ID for Linear notifications\",\n        json_schema_extra={\"env\": \"SLACK_DEFAULT_CHANNEL\"},\n    )\n\n    # Request settings\n    slack_timeout_seconds: float = Field(\n        default=30.0,\n        ge=1.0,\n        le=300.0,\n        description=\"Request timeout for Slack API calls in seconds\",\n        json_schema_extra={\"env\": \"SLACK_TIMEOUT_SECONDS\"},\n    )\n\n    @property\n    def is_configured(self) -> bool:\n        \"\"\"Check if Slack integration is properly configured.\"\"\"\n        return self.slack_bot_token is not None and self.slack_signing_secret is not None\n\n\nclass IntegrationServiceConfig(BaseSettings):\n    \"\"\"\n    Main configuration for the Integration Service.\n\n    Aggregates all integration configurations and common settings.\n    \"\"\"\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        case_sensitive=True,\n        extra=\"ignore\",\n    )\n\n    # Common settings\n    redis_url: str = Field(\n        default=\"redis://localhost:6379/0\",\n        description=\"Redis connection URL for state tracking and caching\",\n        json_schema_extra={\"env\": \"REDIS_URL\"},\n    )\n\n    kafka_bootstrap_servers: str = Field(\n        default=\"localhost:9092\",\n        description=\"Kafka bootstrap servers for event streaming\",\n        json_schema_extra={\"env\": \"KAFKA_BOOTSTRAP_SERVERS\"},\n    )\n\n    # Webhook settings\n    webhook_max_retries: int = Field(\n        default=3,\n        ge=0,\n        le=10,\n        description=\"Maximum retry attempts for webhook deliveries\",\n        json_schema_extra={\"env\": \"WEBHOOK_MAX_RETRIES\"},\n    )\n\n    webhook_retry_delay_seconds: float = Field(\n        default=1.0,\n        ge=0.1,\n        le=60.0,\n        description=\"Initial delay between webhook retry attempts\",\n        json_schema_extra={\"env\": \"WEBHOOK_RETRY_DELAY_SECONDS\"},\n    )\n\n    webhook_timeout_seconds: float = Field(\n        default=30.0,\n        ge=1.0,\n        le=300.0,\n        description=\"Timeout for webhook responses\",\n        json_schema_extra={\"env\": \"WEBHOOK_TIMEOUT_SECONDS\"},\n    )\n\n    # Security\n    credential_encryption_key: Optional[SecretStr] = Field(\n        default=None,\n        description=\"32-byte hex key for encrypting stored credentials\",\n        json_schema_extra={\"env\": \"CREDENTIAL_ENCRYPTION_KEY\"},\n    )\n\n    jwt_secret: Optional[SecretStr] = Field(\n        default=None,\n        description=\"Secret key for JWT token signing\",\n        json_schema_extra={\"env\": \"JWT_SECRET\"},\n    )\n\n    jwt_algorithm: str = Field(\n        default=\"HS256\",\n        description=\"JWT signing algorithm\",\n        json_schema_extra={\"env\": \"JWT_ALGORITHM\"},\n    )\n\n    jwt_expiration_hours: int = Field(\n        default=24,\n        ge=1,\n        le=168,\n        description=\"JWT token expiration time in hours\",\n        json_schema_extra={\"env\": \"JWT_EXPIRATION_HOURS\"},\n    )\n\n\n# Singleton instances for easy access\n_linear_config: Optional[LinearConfig] = None\n_slack_config: Optional[SlackConfig] = None\n_service_config: Optional[IntegrationServiceConfig] = None\n\n\ndef get_linear_config() -> LinearConfig:\n    \"\"\"\n    Get the Linear configuration singleton.\n\n    Returns:\n        LinearConfig: Configured Linear integration settings\n\n    Raises:\n        ValidationError: If required environment variables are missing or invalid\n    \"\"\"\n    global _linear_config\n    if _linear_config is None:\n        _linear_config = LinearConfig()\n    return _linear_config\n\n\ndef get_slack_config() -> SlackConfig:\n    \"\"\"\n    Get the Slack configuration singleton.\n\n    Returns:\n        SlackConfig: Configured Slack integration settings\n    \"\"\"\n    global _slack_config\n    if _slack_config is None:\n        _slack_config = SlackConfig()\n    return _slack_config\n\n\ndef get_service_config() -> IntegrationServiceConfig:\n    \"\"\"\n    Get the Integration Service configuration singleton.\n\n    Returns:\n        IntegrationServiceConfig: Common service configuration settings\n    \"\"\"\n    global _service_config\n    if _service_config is None:\n        _service_config = IntegrationServiceConfig()\n    return _service_config\n\n\n# Convenience function to reset singletons (useful for testing)\ndef reset_config():\n    \"\"\"Reset all configuration singletons. Useful for testing.\"\"\"\n    global _linear_config, _slack_config, _service_config\n    _linear_config = None\n    _slack_config = None\n    _service_config = None\n",
        "last_modified": "2026-01-03T17:00:01.392572"
      },
      "task_intent": {
        "title": "001-connect-your-tools",
        "description": "Implement Linear integration into the ACGS2 integration-service to enable bidirectional synchronization between Linear issues and external tools (GitHub, GitLab, Slack). This will make Linear the source of truth for product development workflows by automatically syncing issue states, comments, and metadata across platforms.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-03T17:00:01.377749",
  "last_updated": "2026-01-03T17:00:01.379930"
}