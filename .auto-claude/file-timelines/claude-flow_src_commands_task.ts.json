{
  "file_path": "claude-flow/src/commands/task.ts",
  "main_branch_history": [],
  "task_views": {
    "059-add-jsdoc-coverage-for-claude-flow-typescript-serv": {
      "task_id": "059-add-jsdoc-coverage-for-claude-flow-typescript-serv",
      "branch_point": {
        "commit_hash": "fc6e42927298263034acf989773f3200e422ad17",
        "content": "/**\n * Task Command Module\n *\n * This module provides CLI commands for managing task orchestration across ACGS-2 agent swarms, including:\n * - Orchestrating complex tasks with various strategies (sequential, parallel, hierarchical, consensus)\n * - Setting task priorities to control processing order\n * - Coordinating work distribution across multiple agents\n *\n * @module task\n */\n\nimport { Command } from 'commander';\nimport chalk from 'chalk';\nimport ora from 'ora';\nimport { orchestrateTask } from '../services/taskService';\nimport { getLogger } from '../../../sdk/typescript/src/utils/logger';\nconst logger = getLogger('task');\n\n/**\n * Main task command that provides subcommands for task orchestration management.\n * Use this command to orchestrate complex tasks across the swarm with different strategies and priorities.\n *\n * Available subcommands:\n * - orchestrate: Orchestrate a complex task across the swarm with specified strategy and priority\n *\n * @example\n * ```bash\n * # Orchestrate a task with parallel execution\n * npx claude-flow task orchestrate --task \"Implement authentication system\" --strategy parallel\n *\n * # Orchestrate a critical task with sequential execution\n * npx claude-flow task orchestrate --task \"Fix production bug\" --strategy sequential --priority critical\n *\n * # Orchestrate with hierarchical coordination\n * npx claude-flow task orchestrate --task \"Refactor user module\" --strategy hierarchical --priority high\n * ```\n */\nexport const taskCommand = new Command('task')\n  .description('Manage task orchestration across the swarm');\n\n// Valid orchestration strategies\nconst VALID_STRATEGIES = ['sequential', 'parallel', 'hierarchical', 'consensus'] as const;\n\n/**\n * Valid orchestration strategy types.\n *\n * - sequential: Tasks executed one after another in order\n * - parallel: Tasks executed simultaneously across multiple agents\n * - hierarchical: Coordinator agent oversees specialized worker agents\n * - consensus: Multiple agents collaborate and vote on the best approach\n */\ntype OrchestrationStrategy = typeof VALID_STRATEGIES[number];\n\n// Valid priority levels\nconst VALID_PRIORITIES = ['low', 'medium', 'high', 'critical'] as const;\n\n/**\n * Valid task priority levels.\n *\n * - low: Standard processing time, queued normally\n * - medium: Moderate priority with default processing (default)\n * - high: Expedited processing, prioritized in queue\n * - critical: Immediate attention required, processed first\n */\ntype PriorityLevel = typeof VALID_PRIORITIES[number];\n\n/**\n * Validates if a string is a valid orchestration strategy type.\n *\n * @param strategy - The strategy string to validate\n * @returns True if the strategy is valid (sequential, parallel, hierarchical, or consensus)\n *\n * @example\n * ```typescript\n * if (validateStrategy('parallel')) {\n *   console.log('Valid strategy');\n * }\n * ```\n */\nfunction validateStrategy(strategy: string): strategy is OrchestrationStrategy {\n  return VALID_STRATEGIES.includes(strategy as OrchestrationStrategy);\n}\n\n/**\n * Validates if a string is a valid priority level.\n *\n * @param priority - The priority string to validate\n * @returns True if the priority is valid (low, medium, high, or critical)\n *\n * @example\n * ```typescript\n * if (validatePriority('high')) {\n *   console.log('Valid priority level');\n * }\n * ```\n */\nfunction validatePriority(priority: string): priority is PriorityLevel {\n  return VALID_PRIORITIES.includes(priority as PriorityLevel);\n}\n\nconst orchestrateCommand = new Command('orchestrate')\n  .description('Orchestrate complex tasks across the swarm')\n  .requiredOption('-t, --task <description>', 'Task description')\n  .option('-s, --strategy <type>', `Orchestration strategy (${VALID_STRATEGIES.join(', ')})`, 'parallel')\n  .option('-p, --priority <level>', `Task priority (${VALID_PRIORITIES.join(', ')})`, 'medium')\n  .action(async (options) => {\n    const spinner = ora('Validating orchestration parameters...').start();\n\n        logger.info(chalk.yellow(`\\n\ud83d\udccb Valid strategies: ${VALID_STRATEGIES.join(', ')}`);\n        logger.info(chalk.gray(`\\n  sequential: Tasks executed one after another`);\n        logger.info(chalk.gray(`  parallel: Tasks executed simultaneously`);\n        logger.info(chalk.gray(`  hierarchical: Coordinator oversees specialized agents`);\n        logger.info(chalk.gray(`  consensus: Multiple agents vote on approach`);\n        logger.info(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Implement authentication\" --strategy parallel`);\n        console.log(chalk.gray(`  parallel: Tasks executed simultaneously`));\n        console.log(chalk.gray(`  hierarchical: Coordinator oversees specialized agents`));\n        console.log(chalk.gray(`  consensus: Multiple agents vote on approach`));\n        console.log(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Implement authentication\" --strategy parallel`));\n        process.exit(1);\n      }\n        logger.info(chalk.yellow(`\\n\ud83d\udccb Valid priorities: ${VALID_PRIORITIES.join(', ')}`);\n        logger.info(chalk.gray(`\\n  low: Standard processing time`);\n        logger.info(chalk.gray(`  medium: Moderate priority (default)`);\n        logger.info(chalk.gray(`  high: Expedited processing`);\n        logger.info(chalk.gray(`  critical: Immediate attention required`);\n        logger.info(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Fix production bug\" --priority critical`);\n        console.log(chalk.gray(`  medium: Moderate priority (default)`));\n        console.log(chalk.gray(`  high: Expedited processing`));\n        console.log(chalk.gray(`  critical: Immediate attention required`));\n        console.log(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Fix production bug\" --priority critical`));\n        process.exit(1);\n      }\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Provide a clear, actionable task description`);\n        logger.info(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Implement user authentication system\"`);\n      if (!options.task || options.task.trim().length === 0) {\n        spinner.fail(chalk.red(`\u274c Task description cannot be empty`));\n        logger.warn('empty_task_description');\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Provide a clear, actionable task description`));\n        cliOutput(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Implement user authentication system\"`));\n        process.exit(1);\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Task descriptions should be detailed enough for agents to understand the work`);\n        logger.info(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Design and implement a complete user authentication system with JWT tokens, password hashing, and role-based access control\"`);\n      if (options.task.trim().length < 10) {\n        spinner.fail(chalk.red(`\u274c Task description too short: ${options.task.trim().length} characters`));\n        logger.warn('task_description_too_short', { length: options.task.trim().length });\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Task descriptions should be detailed enough for agents to understand the work`));\n        cliOutput(chalk.gray(`\\nExample: npx claude-flow task orchestrate --task \"Design and implement a complete user authentication system with JWT tokens, password hashing, and role-based access control\"`));\n        process.exit(1);\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Break complex tasks into smaller, manageable units`);\n\n      if (options.task.trim().length > 1000) {\n        spinner.fail(chalk.red(`\u274c Task description too long: ${options.task.trim().length} characters`));\n        logger.warn('task_description_too_long', { length: options.task.trim().length });\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Break complex tasks into smaller, manageable units`));\n        process.exit(1);\n      }\n\n      spinner.text = 'Connecting to ACGS-2 orchestration engine...';\n      logger.info('orchestrate_task_started', { strategy: options.strategy, priority: options.priority, taskLength: options.task.trim().length });\n\n      // Orchestrate the task\n      const result = await orchestrateTask({\n        task: options.task.trim(),\n        strategy: options.strategy,\n        priority: options.priority\n      });\n        logger.info(chalk.blue(`\\n\ud83d\udccb Task Details:`);\n        logger.info(chalk.gray(`   Task ID: ${result.taskId}`);\n        logger.info(chalk.gray(`   Workflow ID: ${result.workflowId}`);\n        logger.info(chalk.gray(`   Strategy: ${options.strategy}`);\n        logger.info(chalk.gray(`   Priority: ${options.priority}`);\n        logger.info(chalk.gray(`   Description: ${options.task}`);\n        console.log(chalk.gray(`   Workflow ID: ${result.workflowId}`));\n        logger.info(chalk.green(`\\n\ud83d\ude80 Task submitted to swarm for orchestration!`);\n        console.log(chalk.gray(`   Priority: ${options.priority}`));\n        console.log(chalk.gray(`   Description: ${options.task}`));\n\n        console.log(chalk.green(`\\n\ud83d\ude80 Task submitted to swarm for orchestration!`));\n            logger.info(chalk.cyan(`\\n\ud83d\udd04 Sequential Strategy: Tasks will be executed one after another`);\n        // Show strategy-specific information\n        switch (options.strategy) {\n            logger.info(chalk.cyan(`\\n\ud83d\udd04 Parallel Strategy: Tasks will be executed simultaneously`);\n            console.log(chalk.cyan(`\\n\ud83d\udd04 Sequential Strategy: Tasks will be executed one after another`));\n            break;\n            logger.info(chalk.cyan(`\\n\ud83d\udd04 Hierarchical Strategy: Coordinator will oversee specialized agents`);\n            console.log(chalk.cyan(`\\n\ud83d\udd04 Parallel Strategy: Tasks will be executed simultaneously`));\n            break;\n            logger.info(chalk.cyan(`\\n\ud83d\udd04 Consensus Strategy: Multiple agents will collaborate and vote`);\n            console.log(chalk.cyan(`\\n\ud83d\udd04 Hierarchical Strategy: Coordinator will oversee specialized agents`));\n            break;\n          case 'consensus':\n            cliOutput(chalk.cyan(`\\n\ud83d\udd04 Consensus Strategy: Multiple agents will collaborate and vote`));\n            break;\n        logger.info(chalk.red(`\\nError: ${result.error}`);\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Make sure the ACGS-2 system is running and accessible`);\n      } else {\n        spinner.fail(chalk.red(`\u274c Failed to orchestrate task`));\n        logger.error('orchestrate_task_failed', { error: result.error });\n        cliOutput(chalk.red(`\\nError: ${result.error}`));\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Make sure the ACGS-2 system is running and accessible`));\n        process.exit(1);\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Make sure Python 3 is installed and available in PATH`);\n\n        logger.info(chalk.yellow(`\\n\ud83d\udca1 Make sure the ACGS-2 core is properly installed`);\n      if (errorMessage.includes('python3')) {\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Make sure Python 3 is installed and available in PATH`));\n      } else if (errorMessage.includes('EnhancedAgentBus')) {\n        cliOutput(chalk.yellow(`\\n\ud83d\udca1 Make sure the ACGS-2 core is properly installed`));\n      }\n\n      process.exit(1);\n    }\n  });\n\ntaskCommand.addCommand(orchestrateCommand);\n",
        "timestamp": "2026-01-04T05:35:52.969195"
      },
      "worktree_state": null,
      "task_intent": {
        "title": "Add JSDoc coverage for claude-flow TypeScript service public exports",
        "description": "Add comprehensive JSDoc documentation to the 45 exported functions/classes across 17 TypeScript files in the claude-flow CLI tool to improve API documentation for enterprise users",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-04T05:35:52.996500",
  "last_updated": "2026-01-04T05:35:53.007981"
}