# ACGS-2 Performance Monitoring Thresholds Configuration
# Constitutional Hash: cdd01ef066bc6cf2
# Version: 1.0.0
# Last Updated: 2025-12-23
#
# This configuration defines validated performance thresholds based on
# production metrics (P99: 3.23ms, 314 RPS, 100% success rate)

# =============================================================================
# CONSTITUTIONAL COMPLIANCE
# =============================================================================
constitutional:
  hash: "cdd01ef066bc6cf2"
  compliance_target: 100.0  # 100% compliance required
  validation_interval: 1s

# =============================================================================
# PERFORMANCE TARGETS (Validated from production benchmarks)
# =============================================================================
performance:
  # Latency thresholds based on P99: 3.23ms achieved (target <5ms)
  latency:
    p50:
      target_ms: 1.0
      warning_ms: 2.0
      critical_ms: 3.0
    p95:
      target_ms: 2.5
      warning_ms: 3.5
      critical_ms: 4.5
    p99:
      target_ms: 3.25        # Current production achievement
      warning_ms: 4.0        # 23% degradation tolerance
      critical_ms: 5.0       # Constitutional target threshold

  # Throughput thresholds based on 314 RPS achieved (target >100 RPS)
  throughput:
    target_rps: 314          # Current production achievement
    warning_rps: 150         # 52% of achieved capacity
    critical_rps: 100        # Constitutional minimum requirement
    max_burst_rps: 500       # Peak capacity limit

  # Error rate thresholds based on 100% success rate
  error_rate:
    target_percent: 0.0      # Target zero errors
    warning_percent: 1.0     # Warning at 1% errors
    critical_percent: 5.0    # Critical at 5% errors
    degraded_percent: 0.5    # Degraded mode trigger

  # Cache performance based on 95% hit rate achieved
  cache:
    hit_rate:
      target_percent: 95     # Current production achievement
      warning_percent: 85    # Constitutional minimum
      critical_percent: 75   # Service degradation threshold
    latency_ms:
      target: 0.5
      warning: 2.0
      critical: 5.0

# =============================================================================
# SYSTEM RESOURCE THRESHOLDS
# =============================================================================
resources:
  cpu:
    target_percent: 50
    warning_percent: 70
    critical_percent: 85
    sustained_duration: 5m

  memory:
    target_percent: 60
    warning_percent: 75
    critical_percent: 90
    sustained_duration: 5m

  disk:
    target_percent: 60
    warning_percent: 80
    critical_percent: 95

  network:
    # Network saturation thresholds
    bandwidth_warning_percent: 70
    bandwidth_critical_percent: 90
    error_rate_warning: 0.01
    error_rate_critical: 0.1

# =============================================================================
# CIRCUIT BREAKER THRESHOLDS
# =============================================================================
circuit_breaker:
  failure_threshold: 5          # Failures before opening
  success_threshold: 3          # Successes before closing
  half_open_max_calls: 3        # Max calls in half-open state
  timeout_seconds: 30           # Reset timeout

  health_thresholds:
    healthy: 0.9               # 90%+ closed breakers
    degraded: 0.5              # 50%+ closed breakers
    critical: 0.3              # <30% closed breakers

# =============================================================================
# ALERT CONFIGURATION
# =============================================================================
alerting:
  # Evaluation and notification intervals
  evaluation_interval: 15s
  notification_cooldown: 5m

  # Severity-based response times
  response_sla:
    critical:
      initial_response: 5m
      resolution_target: 30m
    warning:
      initial_response: 30m
      resolution_target: 4h
    info:
      initial_response: 4h
      resolution_target: 24h

  # Alert grouping configuration
  grouping:
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 4h

  # Notification channels
  channels:
    - name: pagerduty
      severity: [critical]
      enabled: true
    - name: slack
      severity: [critical, warning]
      enabled: true
    - name: email
      severity: [critical, warning, info]
      enabled: true

# =============================================================================
# PERFORMANCE REGRESSION DETECTION
# =============================================================================
regression:
  # Baseline comparison
  baseline_window: 7d
  comparison_window: 1h

  # Regression thresholds (percent degradation from baseline)
  latency_degradation:
    warning_percent: 20
    critical_percent: 50

  throughput_degradation:
    warning_percent: 30
    critical_percent: 50

  error_rate_increase:
    warning_percent: 100    # Double the baseline
    critical_percent: 500   # 5x the baseline

  # Statistical significance
  min_samples: 100
  confidence_level: 0.95

# =============================================================================
# ANTIFRAGILITY MONITORING (Phase 13)
# =============================================================================
antifragility:
  score_target: 10            # Target antifragility score

  health_aggregator:
    enabled: true
    aggregation_interval: 5s
    history_retention: 1h

  recovery_orchestrator:
    enabled: true
    max_concurrent_recoveries: 3
    recovery_timeout: 60s

  chaos_testing:
    enabled: false            # Disabled in production by default
    blast_radius_limit: 0.1   # Max 10% of services
    emergency_stop: true

# =============================================================================
# SLI/SLO DEFINITIONS
# =============================================================================
sli_slo:
  availability:
    slo_target: 99.9          # 99.9% availability
    error_budget_period: 30d
    burn_rate_windows: [1h, 6h, 24h, 7d]

  latency:
    slo_target: 99.0          # 99% of requests under threshold
    threshold_ms: 5           # P99 threshold

  throughput:
    slo_target: 100           # Minimum RPS guarantee
    measurement_window: 5m

  constitutional_compliance:
    slo_target: 100.0         # 100% compliance required
    zero_tolerance: true

# =============================================================================
# METRICS RETENTION
# =============================================================================
retention:
  raw_metrics: 15d
  aggregated_1m: 30d
  aggregated_5m: 90d
  aggregated_1h: 365d
  aggregated_1d: 730d
