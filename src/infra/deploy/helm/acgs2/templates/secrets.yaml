{{/*
ACGS-2 Secrets Template
Constitutional Hash: cdd01ef066bc6cf2

NOTE: In production, use external secret management (Vault, AWS Secrets Manager, etc.)
This template creates placeholder secrets for development/testing.
*/}}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-db-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  username: {{ .Values.postgresql.auth.username | quote }}
  password: {{ .Values.postgresql.auth.password | default "CHANGE_ME" | quote }}
---
{{- if .Values.redis.auth.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-redis-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  password: {{ .Values.redis.auth.password | default "CHANGE_ME" | quote }}
---
{{- end }}
{{- if .Values.policyRegistry.bundleRegistry.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.policyRegistry.bundleRegistry.credentials.secretName }}
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ printf "{\"auths\":{\"%s\":{\"auth\":\"%s\"}}}" .Values.policyRegistry.bundleRegistry.endpoint "" | b64enc | quote }}
---
{{- end }}
{{- if and .Values.monitoring.siem.enabled .Values.monitoring.siem.exporters.splunk.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-splunk-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  hec-token: {{ .Values.monitoring.siem.exporters.splunk.hecToken | default "CHANGE_ME" | quote }}
---
{{- end }}
{{- if and .Values.monitoring.siem.enabled .Values.monitoring.siem.exporters.datadog.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-datadog-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  api-key: {{ .Values.monitoring.siem.exporters.datadog.apiKey | default "CHANGE_ME" | quote }}
---
{{- end }}
{{- if and .Values.identity.oidc.okta.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-okta-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  client-secret: {{ .Values.identity.oidc.okta.clientSecret | default "CHANGE_ME" | quote }}
---
{{- end }}
{{- if and .Values.identity.oidc.azureAd.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "acgs2.fullname" . }}-azure-ad-credentials
  labels:
    {{- include "acgs2.labels" . | nindent 4 }}
type: Opaque
stringData:
  client-secret: {{ .Values.identity.oidc.azureAd.clientSecret | default "CHANGE_ME" | quote }}
{{- end }}
